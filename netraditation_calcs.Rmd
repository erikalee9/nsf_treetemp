---
title: "netradiation_calcs"
author: "Erika Lee"
date: "2024-07-02"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(lterdatasampler)
library(dplyr)
library(ggplot2)
library(readr)
library(readxl)
library(lubridate)
library(plotly)
library(openxlsx)
library(plotly)
library(rstatix)
library(htmlwidgets)
library(RColorBrewer)
library(patchwork)
#package for scientific notation of numbers
library(scales)

setwd("/Volumes/wcnr-network/Research/Kampf/Private/field_data")
```

# Color Set Up

```{r}
#to display the colors
display.brewer.pal(n = 8, name = "Dark2")

#to get the hex number of the colors
brewer.pal(n = 8, name = "Dark2")
```

```{r}
#setting a color-blind friendly custom palette for gb/db/ubn- using RColorBrewer
##blue is green burned, orange is dead burned, green is unburned
three_custom_colors <- c("#2166AC", "#D95F02", "#1B7837")

## orange is burned, green is unburned
two_custom_colors <- c("#D95F02", "#1B7837")
```

```{r}
#to display the colors
display.brewer.pal(n = 8, name = "YlOrRd")

#to get the hex number of the colors
brewer.pal(n = 8, name = "YlOrRd")

#first color is incoming R, second color is outgoing R
solar_rad_colors <- c("#B10026", "#FD8D3C")
```

# Calling in Data

```{r}
#calling in weather station data from n-drive
##persistent zone
persb_wx_15min <- read_excel("nsf/pers_burned/pers_burned_wx_15min_r.xlsx")

persub_wx_15min <- read_excel("nsf/pers_unburned/pers_unburned_wx_15min_r.xlsx")

##transitional
transb_wx_15min <- read_excel("nsf/trans_burned/trans_burned_wx_15min_r.xlsx")

transub_wx_15min <- read_excel("nsf/trans_unburned/trans_unburned_wx_15min_r.xlsx")
```

```{r}
#calling in tree temp data from n-drive
## burned
pers_b_aspects <- read_excel("nsf/105E_pers_burned/105E_pers_b_aspects.xlsx") %>%
  mutate(datetime = ymd_hms(datetime))

trans_b_aspects <- read_excel("nsf/105E_trans_burned/105E_trans_b_aspects.xlsx") %>%
  mutate(datetime = ymd_hms(datetime))

##unburned
pers_ub_aspects <- read_excel("nsf/105E_pers_unburned/105E_pers_ub_aspects.xlsx") %>%
  mutate(datetime = ymd_hms(datetime))

trans_ub_aspects <- read_excel("nsf/105E_trans_unburned/105E_trans_ub_aspects.xlsx") %>%
  mutate(datetime = ymd_hms(datetime))
```

```{r}
#setting a consistent timeframe for all tree temp data for all burned/unburned zones
##has to start at 2024-02-02 due to errors in data at transitional burned site

#tree temp dataframes
start_time <- ymd_hms("2024-02-02 00:00:00")
end_time <- ymd_hms("2024-05-24 00:00:00")

filtered_pers_b_aspects <- pers_b_aspects %>%
  filter(datetime >= start_time & datetime <= end_time) %>%
  #adding in column for site name, for when combining dataframes
  mutate(site = "pers_burned") %>%
  mutate(tree_circ_m = '')

filtered_pers_ub_aspects <- pers_ub_aspects %>%
  filter(datetime >= start_time & datetime <= end_time) %>%
  mutate(site = "pers_unburned")

filtered_trans_b_aspects <- trans_b_aspects %>%
  filter(datetime >= start_time & datetime <= end_time) %>%
  mutate(site = "trans_burned")

filtered_trans_ub_aspects <- trans_ub_aspects %>%
  filter(datetime >= start_time & datetime <= end_time) %>%
  mutate(site = "trans_unburned")
```

```{r}
#creating one compiled dataframe that has all tree temps in it

all_treetemps <- bind_rows(filtered_pers_b_aspects, filtered_pers_ub_aspects, filtered_trans_b_aspects, filtered_trans_ub_aspects)
```

# RL for trees Calculations

Create a 15 min Rl(out) calculation for trees based on the tree temp

```{r}
# Constants
stefan_boltzmann_constant <- 5.67e-8
emissivity <- 0.97
#wedll depth and circumference are in meters
welldepth <- 1
circumference <- 0.40
#average circumference of a lodgepole is ~ 16 inches = 0.40 meters
#picking an average unit depth for well depth of 1 meter

#constant for m2 
m2 = welldepth*circumference

# Define the time interval (15 minutes in seconds)
time_interval_seconds <- 15 * 60

# Calculate incoming longwave radiation and add to dataframe
all_treetemps <- all_treetemps %>%
  #add a date column for calculations later
  mutate(date = as_date(datetime)) %>%
  mutate(
    temp_k= temp + 273.15, # Convert temperature to Kelvin
    tree_RL_in = emissivity * stefan_boltzmann_constant * (temp_k^4) # Calculate longwave radiation
  ) %>%
#the RL_in units are W/m2, the m2 component is 
  #calculating watz (W)
  #W is = to J/s
  mutate(W = tree_RL_in*m2) %>%
  # Convert instantaneous power (W) to energy (J) for each 15-minute interval
  mutate(energy_J = W * time_interval_seconds) %>%
  #adding in a time column for day/night parsing later
  mutate(time = hms(format(datetime, "%H:%M:%S")))
```

```{r}
# Aggregate energy (J) to get daily total energy in Joules
##this daily total energy is the RL out from the trees!
daily_energy_MJ <- all_treetemps %>%
  group_by(date, time, tree_name, site, aspect) %>%
  summarize(daily_energy_J = sum(energy_J, na.rm = TRUE)) %>%
  ungroup() %>%
  # Removing charred and uncharred aspects
  filter(aspect %in% c("north", "south")) %>%
  # Convert Joules to Megajoules
  mutate(daily_energy_MJ = daily_energy_J / 1e6) %>%
  select(-daily_energy_J)
```

Creating south-only daily energy dataframe

```{r}
south_daily_e_MJ <- daily_energy_MJ %>%
  filter(aspect == "south")
```

# Plotting RL

```{r}
#* Not needed/used
#plotting the sum!
# Ensure daily_energy_J is numeric
daily_energy_MJ <- daily_energy_MJ %>%
  mutate(daily_energy_MJ = as.numeric(daily_energy_MJ))

custom_palette <- c(brewer.pal(9, "Set1"), "black")

daily_RL_plot <- ggplot(daily_energy_MJ, aes(x = date, y = daily_energy_MJ, color = tree_name, shape = factor(aspect))) +
  geom_point(size = 3) +  # Use size 3 for points
  facet_wrap(~ site, scales = "free_y") +
  scale_color_manual(values = custom_palette) +  # Using custom palette with 9 colors for tree_name
  scale_shape_manual(values = c(15, 16, 17, 18, 19, 20)) +  # Define shapes for each aspect
  labs(x = "Date", y = "Daily Energy (Joules)", color = "Tree Name", shape = "Aspect") +
  theme_minimal()

print(daily_RL_plot)
```

```{r}
#plotting the mean!
##mean daily dataframe
mean_daily_energy_J <- all_treetemps %>%
  group_by(date, tree_name, site, aspect) %>%
  summarize(daily_energy_J = mean(energy_J, na.rm = TRUE)) %>%
  ungroup()

mean_daily_RL_plot <- ggplot(mean_daily_energy_J, aes(x = date, y = daily_energy_J, color = tree_name, shape = factor(aspect))) +
  geom_point(size = 3) +  # Use size 3 for points
  facet_wrap(~ site, scales = "free_y") +
  scale_color_manual(values = custom_palette) +  # Using custom palette with 9 colors for tree_name
  scale_shape_manual(values = c(15, 16, 17, 18, 19, 20)) +  # Define shapes for each aspect
  labs(x = "Date", y = "Daily Energy (Joules)", color = "Tree Name", shape = "Aspect") +
  theme_minimal() +
  scale_y_continuous(breaks = seq(min(daily_energy_J$daily_energy_J), max(daily_energy_J$daily_energy_J), length.out = 10))

print(daily_RL_plot)
```

```{r}
#coloring only by aspect and not doing a shape

custom_palette <- c("north" = "darkgreen", "south" = "red")

aspect_mean_daily_energy_plot <- ggplot(daily_energy_J, aes(x = date, y = daily_energy_J, color = aspect)) +
  geom_point(size = 3, alpha = 0.7) +  # Use size 3 for points
  facet_wrap(~ site, scales = "free_y") +
  scale_color_manual(values = custom_palette) +  # Using custom palette with 10 colors for aspect
  labs(x = "Date", y = "Daily Energy (Joules)", color = "Aspect") +
  ggtitle("Daily Mean Energy by Aspect and Site") +  # Add title to the plot
  theme_minimal() +
  scale_y_continuous(breaks = seq(min(daily_energy_J$daily_energy_J), max(daily_energy_J$daily_energy_J), length.out = 10))

print(aspect_mean_daily_energy_plot)
```

```{r}
#saving aspect plot
#saving combined plot
ggsave("aspect_mean_daily_energy_plot.png", plot = aspect_mean_daily_energy_plot, width = 10, height = 6, dpi = 300, bg = "white")
```

```{r}
#converting into a plotly graph and saving as an html

plotly_aspect_mean_daily_energy <- ggplotly(aspect_mean_daily_energy_plot)

plotly_aspect_mean_daily_energy

#save as a html website link
htmlwidgets::saveWidget(plotly_aspect_mean_daily_energy, "plotly_aspect_mean_daily_energy.html")
```

# Plotting RL Daily Average for sites

This is plotting the average of the north and south RL energy for each zone/site/burnstatus

```{r}
#creating daily average dataframe
average_daily_energy_by_site <- daily_energy_MJ %>%
  group_by(date, time, site) %>%
  summarize(average_energy_MJ = mean(daily_energy_MJ, na.rm = TRUE)) %>%
  ungroup() %>%
  #adding in columns for linetype purposes when plotting
  mutate(
    burned_status = if_else(grepl("_burned", site), "burned", "unburned"),
    zone = case_when(
      grepl("^pers", site) ~ "persistent",
      grepl("^trans", site) ~ "transitional",
      TRUE ~ NA_character_
    )
  )

##this is giving me the daily average of the north and south aspect outgoing Radiation by site (trans/pers burned/unburned), in megajoules
```

```{r}
#south only average daily energy 
s_avg_daily_e_by_site <- south_daily_e_MJ %>%
  group_by(date, time, site) %>%
  summarize(average_energy_MJ = mean(daily_energy_MJ, na.rm = TRUE)) %>%
  ungroup() %>%
  #adding in columns for linetype purposes when plotting
  mutate(
    burned_status = if_else(grepl("_burned", site), "burned", "unburned"),
    zone = case_when(
      grepl("^pers", site) ~ "persistent",
      grepl("^trans", site) ~ "transitional",
      TRUE ~ NA_character_
    )
  )
```

```{r}
#plotting daily average
avg_daily_energy <- ggplot(average_daily_energy_by_site, aes(x = date, y = average_energy_MJ, color = burned_status, linetype = zone)) +
  geom_line() +
  labs(title = "Average daily RLout by burn status and zone",
       x = "Date",
       y = "Average RL out (MJ)",
       color = "Burn Status",
       linetype = "Zone") +
  theme_minimal() +
  scale_color_manual(values = two_custom_colors)

avg_daily_energy
```

```{r}
#converting to a plotly
plotly_avg_daily_energy <- ggplotly(avg_daily_energy)

#saving ggplot
ggsave("avg_daily_energy.png", plot = avg_daily_energy, width = 10, height = 6, dpi = 300, bg = "white")

#saving plotly as html
htmlwidgets::saveWidget(plotly_avg_daily_energy, "plotly_avg_daily_energy.html")
```

The above plot looks good. Consider splitting it into a day and night plot?

# Day/Night Plots

## Max Daynight Plots

```{r}
#setting a day and night time 
daytime <- hms("08:30:00")
nighttime <- hms("17:30:00")
```

```{r}
#parsing out daytime/nightime dataframe - MAX RLout
dtnt_max_energy_bysite <- average_daily_energy_by_site %>%
  #adding in a day/night column to facet wrap later
  mutate(phase = case_when(
    time >= daytime & time <= nighttime ~ "day",
    time <= daytime | time >= nighttime ~ "night",
    TRUE ~ NA_character_  # If none of the conditions match, handle accordingly
  )) %>%
  group_by(date, site, phase, burned_status, zone) %>%
  summarize(daily_max_energy_MJ = max(average_energy_MJ, na.rm = TRUE))
```

```{r}
#plotting daytime/nighttime plot
dtnt_max_energy_plot <- ggplot(dtnt_max_energy_bysite, aes(x = date, y = daily_max_energy_MJ, color = burned_status, linetype = zone)) +
  geom_line() +   # Add lines
  labs(title = "Maximum RLout by day/night",
       x = "Date",
       y = "Max RL out (MJ)",
       color = "Burn Status",
       linetype = "Zone") +
  theme_minimal() +
  facet_wrap(~ phase) +
  scale_color_manual(values = two_custom_colors)

dtnt_max_energy_plot
```

```{r}
#converting to a plotly
plotly_dtnt_max_energy <- ggplotly(dtnt_max_energy_plot)

plotly_dtnt_max_energy
```

```{r}
#saving ggplot
ggsave("dtnt_max_RLout_plot.png", plot = dtnt_max_energy_plot, width = 10, height = 6, dpi = 300, bg = "white")


#saving plotly as a html website link
htmlwidgets::saveWidget(plotly_dtnt_max_energy, "plotly_dtnt_max_RLout.html")
```

## Avg Daynight Plots

```{r}
{r}
#parsing out daytime/nightime dataframe - AVG RLout
dtnt_avg_energy_bysite <- average_daily_energy_by_site %>%
  #adding in a day/night column to facet wrap later
  mutate(phase = case_when(
    time >= daytime & time <= nighttime ~ "day",
    time <= daytime | time >= nighttime ~ "night",
    TRUE ~ NA_character_  # If none of the conditions match, handle accordingly
  )) %>%
  group_by(date, site, phase, burned_status, zone) %>%
  summarize(daily_avg_energy_MJ = mean(average_energy_MJ, na.rm = TRUE))
```

```{r}
#plotting daytime/nighttime plot
dtnt_avg_energy_plot <- ggplot(dtnt_avg_energy_bysite, aes(x = date, y = daily_avg_energy_MJ, color = burned_status, linetype = zone)) +
  geom_line() +   # Add lines
  labs(title = "Average RLout by day/night",
       x = "Date",
       y = "Avg RL out (MJ)",
       color = "Burn Status",
       linetype = "Zone") +
  theme_minimal() +
  facet_wrap(~ phase) +
  scale_color_manual(values = two_custom_colors)

dtnt_avg_energy_plot
```

```{r}
#converting to a plotly
plotly_dtnt_avg_energy <- ggplotly(dtnt_avg_energy_plot)

plotly_dtnt_avg_energy
```

```{r}
#saving ggplot
ggsave("dtnt_avg_RLout_plot.png", plot = dtnt_avg_energy_plot, width = 10, height = 6, dpi = 300, bg = "white")


#saving plotly as a html website link
htmlwidgets::saveWidget(plotly_dtnt_avg_energy, "plotly_dtnt_avg_RLout.html")
```

## South-only Max/Avg day/night 

```{r}
#south only dtnt_max energy by site
s_dtnt_max_e <- s_avg_daily_e_by_site %>%
  #adding in a day/night column to facet wrap later
  mutate(phase = case_when(
    time >= daytime & time <= nighttime ~ "day",
    time <= daytime | time >= nighttime ~ "night",
    TRUE ~ NA_character_  # If none of the conditions match, handle accordingly
  )) %>%
  group_by(date, site, phase, burned_status, zone) %>%
  summarize(daily_max_energy_MJ = max(average_energy_MJ, na.rm = TRUE))
```

```{r}
#south only dtnt_avg energy by site
s_dtnt_avg_e <- s_avg_daily_e_by_site %>%
  #adding in a day/night column to facet wrap later
  mutate(phase = case_when(
    time >= daytime & time <= nighttime ~ "day",
    time <= daytime | time >= nighttime ~ "night",
    TRUE ~ NA_character_  # If none of the conditions match, handle accordingly
  )) %>%
  group_by(date, site, phase, burned_status, zone) %>%
  summarize(daily_avg_energy_MJ = mean(average_energy_MJ, na.rm = TRUE))
```

# Final Day/Night Plots

```{r}
#south-only dataframes, arranged correctly

#plotting daytime/nighttime plot
s_dtnt_avg_energy_plot <- ggplot(s_dtnt_avg_e, aes(x = date, y = daily_avg_energy_MJ, color = burned_status, linetype = zone)) +
  geom_line() +   # Add lines
  labs(title = "South Aspect Average Tree RL by day/night",
       x = "Date",
       y = "Avg RL out (MJ)",
       color = "Burn Status",
       linetype = "Zone") +
  theme_minimal() +
  facet_wrap(~ phase, dir = "h") +
  scale_color_manual(values = two_custom_colors)

s_dtnt_avg_energy_plot
```

# Tree RL + Weather Station Data

## Data Wrangling

### Weather station data

```{r}
#setting a different end-time because weather station data from persistent zone only goes to 4-22
end_time_2 <- ymd_hms("2024-04-20 00:00:00")

#filtered weather station data
filtered_pers_b_wx <- persb_wx_15min %>%
  filter(datetime >= start_time & datetime <= end_time_2) %>%
  mutate(zone = "persistent") %>%
  mutate(burn_status = "burned") %>%
  mutate(date = as_date(datetime),time = format(datetime, "%H:%M:%S"))%>%
  select(c(datetime, date, time, zone, burn_status, SWin_Avg, SWout_Avg, LWin_Avg, LWout_Avg))

filtered_pers_ub_wx <- persub_wx_15min %>%
  filter(datetime >= start_time & datetime <= end_time_2) %>%
  mutate(zone = "persistent") %>%
  mutate(burn_status = "unburned") %>%
  mutate(date = as_date(datetime),time = format(datetime, "%H:%M:%S"))%>%
  select(c(datetime, date, time, zone, burn_status, SWin_Avg, SWout_Avg, LWin_Avg, LWout_Avg))

filtered_trans_b_wx <- transb_wx_15min %>%
  filter(datetime >= start_time & datetime <= end_time_2) %>%
  mutate(zone = "transitional") %>%
  mutate(burn_status = "burned") %>%
  mutate(date = as_date(datetime),time = format(datetime, "%H:%M:%S"))%>%
  select(c(datetime, date, time, zone, burn_status, SWin_Avg, SWout_Avg, LWin_Avg, LWout_Avg))

filtered_trans_ub_wx <- transub_wx_15min %>%
  filter(datetime >= start_time & datetime <= end_time_2) %>%
  mutate(zone = "transitional") %>%
  mutate(burn_status = "unburned") %>%
  mutate(date = as_date(datetime),time = format(datetime, "%H:%M:%S"))%>%
  select(c(datetime, date, time, zone, burn_status, SWin_Avg, SWout_Avg, LWin_Avg, LWout_Avg))

#ensuring that the values are numeric for all columns
# Ensure all joining columns have the same type across all dataframes
filtered_pers_b_wx <- filtered_pers_b_wx %>%
  mutate(
    SWin_Avg = as.numeric(SWin_Avg),
    SWout_Avg = as.numeric(SWout_Avg),
    LWin_Avg = as.numeric(LWin_Avg),
    LWout_Avg = as.numeric(LWout_Avg)
  )

filtered_pers_ub_wx <- filtered_pers_ub_wx %>%
  mutate(
    SWin_Avg = as.numeric(SWin_Avg),
    SWout_Avg = as.numeric(SWout_Avg),
    LWin_Avg = as.numeric(LWin_Avg),
    LWout_Avg = as.numeric(LWout_Avg)
  ) 

filtered_trans_b_wx <- filtered_trans_b_wx %>%
  mutate(
    SWin_Avg = as.numeric(SWin_Avg),
    SWout_Avg = as.numeric(SWout_Avg),
    LWin_Avg = as.numeric(LWin_Avg),
    LWout_Avg = as.numeric(LWout_Avg)
  )

filtered_trans_ub_wx <- filtered_trans_ub_wx %>%
  mutate(
    SWin_Avg = as.numeric(SWin_Avg),
    SWout_Avg = as.numeric(SWout_Avg),
    LWin_Avg = as.numeric(LWin_Avg),
    LWout_Avg = as.numeric(LWout_Avg)
  )


combined_filtered_wx_RL_data <- filtered_pers_b_wx %>%
  full_join(filtered_pers_ub_wx) %>%
  full_join(filtered_trans_b_wx) %>%
  full_join(filtered_trans_ub_wx) %>%
  full_join(average_daily_energy_by_site)

combined_filtered_wx_data <- combined_filtered_wx_RL_data
```

Tree temp data

```{r}
#rerunning these to parse by datetime, not date and time, then will add in date and time later!
daily_energy_MJ <- all_treetemps %>%
  group_by(datetime, tree_name, site, aspect) %>%
  summarize(daily_energy_J = sum(energy_J, na.rm = TRUE)) %>%
  ungroup() %>%
  # Removing charred and uncharred aspects
  filter(aspect %in% c("north", "south")) %>%
  # Convert Joules to Megajoules
  mutate(daily_energy_MJ = daily_energy_J / 1e6) %>%
  select(-daily_energy_J)


average_daily_energy_by_site <- daily_energy_MJ %>%
  group_by(datetime, site) %>%
  summarize(average_energy_MJ = mean(daily_energy_MJ, na.rm = TRUE)) %>%
  ungroup() %>%
  #adding in columns for linetype purposes when plotting
  mutate(
    burned_status = if_else(grepl("_burned", site), "burned", "unburned"),
    zone = case_when(
      grepl("^pers", site) ~ "persistent",
      grepl("^trans", site) ~ "transitional",
      TRUE ~ NA_character_
    )
  )
```

```{r}
avg_daily_e_bysite <- average_daily_energy_by_site %>%
  select(-site) %>%
  rename(tree_LWout_avg_MJ = "average_energy_MJ") %>%
  mutate(date = as_date(datetime),time = format(datetime, "%H:%M:%S")) %>%
  rename(burn_status = "burned_status") %>%
  #filtering so end date is in April, not May
  filter(datetime >= start_time & datetime <= end_time_2) %>%
  select(-datetime) %>%
  select(date, time, zone, burn_status, everything()) 
```

```{r}
#setting a day and night time 
daytime <- hms("08:30:00")
nighttime <- hms("17:30:00")
```

```{r}
#combining wx station R data and tree LWout data
combined_wx_treeRout_data <- combined_filtered_wx_data %>%
  full_join(avg_daily_e_bysite) %>%
  drop_na() %>%
  #converting the time column so I can use lubridate for phase creation
  mutate(time = hms(time)) %>%
  mutate(phase = case_when(
    time >= daytime & time < nighttime ~ "day",
    time < daytime | time >= nighttime ~ "night",
    TRUE ~ NA_character_  # Handle cases where none of the conditions match
  ))
```

```{r}
#creating a daily and nightly average dataframe that just gives one reading per day/night that is the average of the whole day/night
daily_avg_combined_R_data <- combined_wx_treeRout_data %>%
  group_by(date, zone, burn_status, phase) %>%           # Group by the 'date' column
  summarize(across(everything(), mean, na.rm = TRUE)) %>%
  select(-time)
```

## Plotting Wx R data and Tree LWout data

```{r}
# Define custom colors and line types
color_values <- c(
  "SWin_Avg" = "blue",
  "SWout_Avg" = "red",
  "LWin_Avg" = "green",
  "LWout_Avg" = "purple",
  "tree_LWout_avg_MJ" = "orange"
)

# Define line types based on burn_status
line_types <- c(
  "burned" = "solid",
  "unburned" = "dashed"
)

```

This plot looks really scattered, and the y-values are too spread out, so I am going to try to plot a different way below

```{r}
test_wxR_plot <- ggplot(daily_avg_combined_R_data) +
  geom_line(aes(x = date, y = SWin_Avg, color = "SWin_Avg", linetype = burn_status)) +
  geom_line(aes(x = date, y = SWout_Avg, color = "SWout_Avg", linetype = burn_status)) +
  geom_line(aes(x = date, y = LWin_Avg, color = "LWin_Avg", linetype = burn_status)) +
  geom_line(aes(x = date, y = LWout_Avg, color = "LWout_Avg", linetype = burn_status)) +
  geom_line(aes(x = date, y = tree_LWout_avg_MJ, color = "tree_LWout_avg_MJ", linetype = burn_status)) +
  facet_wrap(~ zone + phase, scales = "free_y", dir = "v") +  # Facet by zone and phase
  labs(
    title = "Average Daily Radiation Components",
    x = "Date",
    y = "Value",
    color = "Variable",
    linetype = "Burn Status"
  ) +
  theme_minimal() +  # Use a minimal theme for a clean look
  scale_color_manual(values = color_values) +  # Customize color scheme
  scale_linetype_manual(values = line_types)  # Customize line types

# Print the plot
print(test_wxR_plot)
```

Plotting day-only SW and LW plots, with a seperate MJ plot

```{r}
#dt dataframes
daytime_avg_combined_R_data <- daily_avg_combined_R_data %>%
  filter(phase == "day")
```

```{r}
#plotting individual plotsm then arranging using ggarrange

dt_persistent_Rplot <- ggplot(daytime_avg_combined_R_data) +
  geom_line(aes(x = date, y = SWin_Avg, color = "SWin_Avg", linetype = burn_status)) +
  geom_line(aes(x = date, y = SWout_Avg, color = "SWout_Avg", linetype = burn_status)) +
  geom_line(aes(x = date, y = LWin_Avg, color = "LWin_Avg", linetype = burn_status)) +
  geom_line(aes(x = date, y = LWout_Avg, color = "LWout_Avg", linetype = burn_status)) +
  facet_wrap(~ zone + burn_status, scales = "free_y", dir = "v") +  # Facet by zone and phase
  labs(
    title = "Average Daily Radiation Components",
    x = "Date",
    y = "Value",
    color = "Variable",
    linetype = "Burn Status"
  ) +
  theme_minimal() +  # Use a minimal theme for a clean look
  scale_color_manual(values = color_values) +  # Customize color scheme
  scale_linetype_manual(values = line_types)

dt_persistent_Rplot
```
