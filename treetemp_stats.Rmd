---
title: "treetemp_stats"
author: "Erika Lee"
date: "2024-07-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Stats Calculations

```{r}
#initial set up
library(tidyverse)
library(lterdatasampler)
library(dplyr)
library(ggplot2)
library(readr)
library(readxl)
library(lubridate)
library(plotly)
library(openxlsx)
library(plotly)
library(rstatix)
library(htmlwidgets)
library(RColorBrewer)
library(patchwork)
#packages for exporting csvs as tables
library(knitr)
library(kableExtra)
library(pagedown)

setwd("/Volumes/wcnr-network/Research/Kampf/Private/field_data")
```

```{r}
#clear prior environment
rm(list = ls())
```

## Loading Data

-   I don't think I need all of these dataframes, but I'll need to rework the stats so that I pull from only the combined dataframes in the second chunk below!

-   I should just be able to create new dataframes for burned/unburned from the combined one, that way I need less dataframes exported/stored in N-drive!

```{r}
final_15min_ns_b <- read_csv("nsf/treetemp_data/final_15min_ns_b.csv")

final_15min_ns_ub <- read_csv("nsf/treetemp_data/final_15min_ns_ub.csv")

final_hourly_ns_b <- read_csv("nsf/treetemp_data/final_hourly_ns_b.csv")

final_hourly_ns_ub <- read_csv("nsf/treetemp_data/final_hourly_ns_ub.csv")

final_15min_gbdb <- read_csv("nsf/treetemp_data/final_15min_gbdb.csv")

final_15min_gbdb_ub <- read_csv("nsf/treetemp_data/final_15min_gbdb_ub.csv")

final_15min_gbub <- read_csv("nsf/treetemp_data/final_15min_gbub.csv")

final_15min_dbub <- read_csv("nsf/treetemp_data/final_15min_dbub.csv")

final_hourly_gbdb <- read_csv("nsf/treetemp_data/final_hourly_gbdb.csv")

final_hourly_gbdb_ub <- read_csv("nsf/treetemp_data/final_hourly_gbdb_ub.csv")

final_hourly_gbub <- read_csv("nsf/treetemp_data/final_hourly_gbub.csv")

final_hourly_dbub <- read_csv("nsf/treetemp_data/final_hourly_dbub.csv")

final_daynight_singleavg_temps <- read_csv("nsf/treetemp_data/final_daynight_singleavg_temps.csv")
```

\*\* I think I only need the following imports!

```{r}
p_b_solar_times <- read_csv("nsf/treetemp_data/p_b_solar_times.csv") %>%
  mutate(
    sunrise = as.POSIXct(sunrise, format = "%Y-%m-%d %H:%M:%S", tz = "UTC"), # Assuming data is in UTC
    sunset = as.POSIXct(sunset, format = "%Y-%m-%d %H:%M:%S", tz = "UTC"),
    sunrise = with_tz(sunrise, "MST"),  # Convert to MST timezone
    sunset = with_tz(sunset, "MST")     # Convert to MST timezone
  )
```

```{r}
#new full dataframes to load - including burned and unburned/ all burn_status types together
full_15min_ns <- read_csv("nsf/treetemp_data/full_15min_ns.csv") %>%
  mutate(datetime = as.POSIXct(datetime, format=("%Y-%m-%d %H:%M:%S")),
                               datetime = with_tz(datetime, tz = 'MST')) %>%
  mutate(day = as.Date(day, format = ("%Y-%m-%d"))) %>%
  inner_join(p_b_solar_times, by = "day") %>%
  #creating a phase column that parses by daily sunrise/sunset times
  mutate(
    phase = case_when(
      datetime >= sunrise & datetime < sunset ~ "day",
      datetime < sunrise ~ "night",
      datetime >= sunset ~ "night",
      TRUE ~ NA_character_)) %>%
  select(datetime, day, month, phase, zone, snow_phase, burn_status, north_temp, south_temp, solarNoon, sunrise, sunset, dawn, dusk)

#full_hourly_ns <- read_csv("nsf/treetemp_data/full_hourly_ns.csv") %>%
   #mutate(datetime_hour = as.POSIXct(datetime_hour, format=("%Y-%m-%d %H:%M:%S")),
                              # datetime_hour = force_tz(datetime_hour, tz = 'MST'))  %>%
#  select(-1)

full_15min_gbdbub <- read_csv("nsf/treetemp_data/full_15min_gbdbub.csv") %>%
  mutate(datetime = as.POSIXct(datetime, format=("%Y-%m-%d %H:%M:%S")),
                               datetime = with_tz(datetime, tz = 'MST')) %>%
  mutate(day = as.Date(day, format = ("%Y-%m-%d"))) %>%
  inner_join(p_b_solar_times, by = "day") %>%
  #creating a phase column that parses by daily sunrise/sunset times
  mutate(
    phase = case_when(
      datetime >= sunrise & datetime < sunset ~ "day",
      datetime < sunrise ~ "night",
      datetime >= sunset ~ "night",
      TRUE ~ NA_character_)) %>%
  select(datetime, day, month, phase, zone, snow_phase, aspect, gb_temp, db_temp, ub_temp, solarNoon, sunrise, sunset, dawn, dusk)

#full_hourly_gbdbub <- read_csv("nsf/treetemp_data/full_hourly_gbdbub.csv") %>%
 # mutate(datetime_hour = as.POSIXct(datetime_hour, format=("%Y-%m-%d %H:%M:%S")),
                          #     datetime_hour = force_tz(datetime_hour, tz = 'MST'))  %>%
  #select(-1)

full_hourly_gb <- read_csv("nsf/treetemp_data/full_hourly_gb.csv") %>%
  mutate(datetime_hour = as.POSIXct(datetime_hour, format=("%Y-%m-%d %H:%M:%S")),
                               datetime_hour = force_tz(datetime_hour, tz = 'MST'))

#day/night comparisons
full_dtnt_ns_temps <- read_csv("nsf/treetemp_data/full_dtnt_ns_temps.csv")
```

## Calculating Stats

### N/S Differenced Data

Based on meeting w/ Stephanie on 7/17/24 - I already calculated avg_temp for 15min timestep in "data_wrangling" rmarkdown, now I will calculate the mean_diff for 15minute timestep, then do the other calculations by month

```{r}
## don't use this one!
#burned n/s stats
stats_monthly_ns <- full_15min_ns %>%
  filter(phase == "day") %>%
  #changing zone names to be PSZ and TSZ
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  )) %>%
  # calculating monthly stats
  group_by(month, zone, burn_status) %>%
  summarize(
    mean_north_temp = mean(north_temp),
    mean_south_temp = mean(south_temp),
    mean_temp = mean(ns_avg_temp),
    mean_temp_diff = mean(ns_temp_diff),
    sd = sd(ns_temp_diff, na.rm = TRUE),
    coeff_var = (sd(ns_temp_diff, na.rm = TRUE) / abs(mean(ns_temp_diff, na.rm = TRUE)))
  ) %>%
  # rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3)
```

```{r}
##GB N/S differences
stats_monthly_ns_gb <- stats_monthly_ns %>%
  filter(burn_status == "green burn") %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

```{r}
##DB N/S differences
stats_monthly_ns_db <- stats_monthly_ns %>%
  filter(burn_status == "dead burn") %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

```{r}
##Live N/S differences
stats_monthly_ns_ub <- stats_monthly_ns %>%
  filter(burn_status == "live") %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

Exporting N/S GB,DB,UB data

```{r}
write.csv(stats_monthly_ns_gb, "nsf/treetemp_data/final_stats_tables/stats_monthly_ns_gb.csv")

write.csv(stats_monthly_ns_db, "nsf/treetemp_data/final_stats_tables/stats_monthly_ns_db.csv")

write.csv(stats_monthly_ns_ub, "nsf/treetemp_data/final_stats_tables/stats_monthly_ns_ub.csv")
```

### GB Differenced Data Only

```{r}
#GB N/S difference
stats_monthly_gb_ns <- full_hourly_gb %>%
  filter(phase == "day") %>%
  #changing zone names to be PSZ and TSZ
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  )) %>%
  group_by(month, zone, burn_status) %>%
  summarize(mean_south_temp = mean(south_temp), mean_north_temp = mean(north_temp), ns_mean_temp = mean(ns_avg_temp), mean_temp_diff = mean(ns_temp_diff), sd = sd(ns_temp_diff, na.rm = TRUE),
    coeff_var = (sd(ns_temp_diff, na.rm = TRUE) / abs(mean(ns_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

### Charred/Uncharred Differenced Data

```{r}
#GB C/UC difference
stats_monthly_gb_cuc <- full_hourly_gb %>%
  filter(phase == "day") %>%
  #changing zone names to be PSZ and TSZ
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  )) %>%
  group_by(month, zone, burn_status) %>%
  summarize(mean_charred_temp = mean(charred_temp), mean_uncharred_temp = mean(uncharred_temp), cuc_mean_temp = mean(cuc_avg_temp), mean_temp_diff = mean(ns_temp_diff), sd = sd(ns_temp_diff, na.rm = TRUE),
    coeff_var = (sd(ns_temp_diff, na.rm = TRUE) / abs(mean(ns_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

### South / Uncharred Differenced Data

```{r}
#GB S/UC Difference
stats_monthly_gb_suc <- full_hourly_gb %>%
  filter(phase == "day") %>%
  #changing zone names to be PSZ and TSZ
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  )) %>%
  group_by(month, zone, burn_status) %>%
  summarize(mean_south_temp = mean(south_temp), mean_uncharred_temp = mean(uncharred_temp), suc_mean_temp = mean(suc_avg_temp), mean_temp_diff = mean(suc_temp_diff), sd = sd(suc_temp_diff, na.rm = TRUE),
    coeff_var = (sd(suc_temp_diff, na.rm = TRUE) / abs(mean(suc_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

### South / Charred Differenced Data

```{r}
#GB S/C Difference
stats_monthly_gb_sc <- full_hourly_gb %>%
  filter(phase == "day") %>%
  #changing zone names to be PSZ and TSZ
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  )) %>%
  group_by(month, zone, burn_status) %>%
  summarize(mean_south_temp = mean(south_temp), mean_charred_temp = mean(charred_temp), sc_mean_temp = mean(sc_avg_temp), mean_temp_diff = mean(sc_temp_diff), sd = sd(sc_temp_diff, na.rm = TRUE),
    coeff_var = (sd(sc_temp_diff, na.rm = TRUE) / abs(mean(sc_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

### North / Uncharred Differenced Data

```{r}
#GB N/UC Difference
stats_monthly_gb_nuc <- full_hourly_gb %>%
  filter(phase == "day") %>%
  #changing zone names to be PSZ and TSZ
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  )) %>%
  group_by(month, zone, burn_status) %>%
  summarize(mean_north_temp = mean(north_temp), mean_uncharred_temp = mean(uncharred_temp), nuc_mean_temp = mean(nuc_avg_temp), mean_temp_diff = mean(nuc_temp_diff), sd = sd(nuc_temp_diff, na.rm = TRUE),
    coeff_var = (sd(nuc_temp_diff, na.rm = TRUE) / abs(mean(nuc_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

### North / Charred Differenced Data

```{r}
#GB N/C Difference
stats_monthly_gb_nc <- full_hourly_gb %>%
  filter(phase == "day") %>%
  #changing zone names to be PSZ and TSZ
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  )) %>%
  group_by(month, zone, burn_status) %>%
  summarize(mean_north_temp = mean(north_temp), mean_charred_temp = mean(charred_temp), nc_mean_temp = mean(nc_avg_temp), mean_temp_diff = mean(nc_temp_diff), sd = sd(nc_temp_diff, na.rm = TRUE),
    coeff_var = (sd(nc_temp_diff, na.rm = TRUE) / abs(mean(nc_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

```{r}
#exporting final tables
write.csv(stats_monthly_gb_ns, "nsf/treetemp_data/final_stats_tables/stats_monthly_gb_ns.csv")

write.csv(stats_monthly_gb_cuc, "nsf/treetemp_data/final_stats_tables/stats_monthly_gb_cuc.csv")

write.csv(stats_monthly_gb_suc, "nsf/treetemp_data/final_stats_tables/stats_monthly_gb_suc.csv")

write.csv(stats_monthly_gb_sc, "nsf/treetemp_data/final_stats_tables/stats_monthly_gb_sc.csv")

write.csv(stats_monthly_gb_nuc, "nsf/treetemp_data/final_stats_tables/stats_monthly_gb_nuc.csv")

write.csv(stats_monthly_gb_nc, "nsf/treetemp_data/final_stats_tables/stats_monthly_gb_nc.csv")
```

### GB/DB Differenced Data

```{r}
#gb/db stats - db minus gb! 
stats_monthly_gbdb <- full_15min_gbdbub %>%
  filter(phase == "day") %>%
  #calculating monthly stats
  group_by(month, zone) %>%
  summarize(mean_gb_temp = mean(gb_temp), mean_db_temp = mean(db_temp), mean_temp = mean(gbdb_avg_temp), mean_diff = mean(gbdb_temp_diff), sd = sd(gbdb_temp_diff, na.rm = TRUE),
    coeff_var = (sd(gbdb_temp_diff, na.rm = TRUE) / abs(mean(gbdb_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

### GB/UB Differenced Data

```{r}
#gb/ub stats - gb minus ub! 
stats_monthly_gbub <- full_15min_gbdbub %>%
  filter(phase == "day") %>%
  #calculating monthly stats
  group_by(month, zone) %>%
  summarize(mean_gb_temp = mean(gb_temp), mean_live_temp = mean(ub_temp), mean_temp = mean(gbub_avg_temp), mean_diff = mean(gbub_temp_diff), sd = sd(gbub_temp_diff, na.rm = TRUE),
    coeff_var = (sd(gbub_temp_diff, na.rm = TRUE) / abs(mean(gbub_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

### DB/UB Differenced Data

```{r}
#db/ub stats - db minus ub! 
stats_monthly_dbub <- full_15min_gbdbub %>%
  filter(phase == "day") %>%
  #calculating monthly stats
  group_by(month, zone) %>%
  summarize(mean_db_temp = mean(db_temp), mean_live_temp = mean(ub_temp), mean_temp = mean(dbub_avg_temp), mean_diff = mean(dbub_temp_diff), sd = sd(dbub_temp_diff, na.rm = TRUE),
    coeff_var = (sd(dbub_temp_diff, na.rm = TRUE) / abs(mean(dbub_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3) %>%
  arrange(factor(zone, levels = c("PSZ", "TSZ")), month)
```

```{r}
write.csv(stats_monthly_gbdb, "nsf/treetemp_data/final_stats_tables/stats_monthly_gbdb.csv")

write.csv(stats_monthly_gbub, "nsf/treetemp_data/final_stats_tables/stats_monthly_gbub.csv")

write.csv(stats_monthly_dbub, "nsf/treetemp_data/final_stats_tables/stats_monthly_dbub.csv")
```

### Day/Night Differenced Data

\*\* only comparing north/south differences for individual burn status, not between burn statuses

\*\* KEEP WORKING ON THIS - the stats are not calculating on a monthly basis...

```{r}
#monthly stats calculations by day/night zone & burn status
stats_monthly_dtnt <- full_dtnt_ns_temps %>%
  # Filtering out rows with NAs in critical columns before grouping
  filter(!is.na(dt_north_temp) & !is.na(dt_south_temp) & !is.na(nt_north_temp) &
         !is.na(nt_south_temp) & !is.na(n_avg_temp) & !is.na(s_avg_temp) &
         !is.na(dt_avg_temp) & !is.na(nt_avg_temp) & !is.na(n_dtnt_temp_diff) &
         !is.na(s_dtnt_temp_diff)) %>%
  # Calculating monthly stats
  group_by(month, zone, burn_status) %>%
  summarize(
    dt_north_temp = mean(dt_north_temp, na.rm = TRUE),
    dt_south_temp = mean(dt_south_temp, na.rm = TRUE),
    nt_north_temp = mean(nt_north_temp, na.rm = TRUE),
    nt_south_temp = mean(nt_south_temp, na.rm = TRUE),
    n_mean_temp = mean(n_avg_temp, na.rm = TRUE),
    s_mean_temp = mean(s_avg_temp, na.rm = TRUE),
    dt_mean_temp = mean(dt_avg_temp, na.rm = TRUE),
    nt_mean_temp = mean(nt_avg_temp, na.rm = TRUE),
    n_dtnt_temp_diff = mean(n_dtnt_temp_diff, na.rm = TRUE),
    s_dtnt_temp_diff = mean(s_dtnt_temp_diff, na.rm = TRUE),
    n_sd = sd(n_dtnt_temp_diff, na.rm = TRUE),
    n_coeff_var = ifelse(
      !is.na(n_sd) & abs(mean(n_dtnt_temp_diff, na.rm = TRUE)) > 0,
      n_sd / abs(mean(n_dtnt_temp_diff, na.rm = TRUE)),
      NA
    ),
    s_sd = sd(s_dtnt_temp_diff, na.rm = TRUE),
    s_coeff_var = ifelse(
      !is.na(s_sd) & abs(mean(s_dtnt_temp_diff, na.rm = TRUE)) > 0,
      s_sd / abs(mean(s_dtnt_temp_diff, na.rm = TRUE)),
      NA
    )
  ) %>%
  # Rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3)
```

Creating tables by burn_status

```{r}
stats_monthly_dtnt_gb <- stats_monthly_dtnt %>%
  filter(burn_status == "green burn")
```

\*\* keep working on what's below this! - 10/28/24

Formatting N/S Stats Monthly Tables and Exporting

\*\* this format for a table looks good and works. I just need to figure out what tables I want to use! (2024-10-22 note)

```{r}
#GB N/S Comparison
final_stats_gb_ns_table_P <- stats_monthly_ns_gb %>% 
  filter(zone == "PSZ") 

final_stats_gb_ns_table_T <- stats_monthly_ns_gb %>% 
  filter(zone == "TSZ") 

final_stats_monthly_ns_gb_table <- rbind(final_stats_gb_ns_table_P, final_stats_gb_ns_table_T)

final_stats_monthly_ns_gb_table <- final_stats_monthly_ns_gb_table %>%
  select(-burn_status) %>%
  rename(
    "north temp" = mean_north_temp,
    "south temp" = mean_south_temp,
    "mean temp" = mean_temp,
    "temp difference" = mean_temp_diff,
    "coefficient of variance" = coeff_var
  ) %>%
  kbl(caption = "Green Burn North/South") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_material("striped") %>%
  row_spec(0, hline_after = TRUE, extra_css = "border-bottom: 2px solid;") %>%
  row_spec(4, hline_after = TRUE, extra_css = "border-bottom: 2px solid;")

print(final_stats_monthly_ns_gb_table)
```

```{r}
#DB N/S Comparison
final_stats_db_ns_table_P <- stats_monthly_ns_db %>% 
  filter(zone == "PSZ") 

final_stats_db_ns_table_T <- stats_monthly_ns_db %>% 
  filter(zone == "TSZ") 

final_stats_monthly_ns_db_table <- rbind(final_stats_db_ns_table_P, final_stats_db_ns_table_T)

final_stats_monthly_ns_db_table <- final_stats_monthly_ns_db_table %>%
  select(-burn_status) %>%
  rename("north temp" = mean_north_temp, "south temp" = mean_south_temp, "mean temp" = mean_temp, "temp difference" = mean_temp_diff, "coefficient of variance" = coeff_var) %>%
  kbl(caption = "Dead Burn North/South") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_material("striped") %>%
  row_spec(0, hline_after = TRUE, extra_css = "border-bottom: 2px solid;") %>%
  row_spec(4, hline_after = TRUE, extra_css = "border-bottom: 2px solid;")

print(final_stats_monthly_ns_db_table)
```

```{r}
#UB N/S Comparison
final_stats_ub_ns_table_P <- stats_monthly_ns_ub %>% 
  filter(zone == "PSZ")

final_stats_ub_ns_table_T <- stats_monthly_ns_ub %>% 
  filter(zone == "TSZ") 

final_stats_monthly_ns_ub_table <- rbind(final_stats_ub_ns_table_P, final_stats_ub_ns_table_T)

final_stats_monthly_ns_ub_table <- final_stats_monthly_ns_ub_table %>%
  select(-burn_status) %>%
  rename("north temp" = mean_north_temp, "south temp" = mean_south_temp, "mean temp" = mean_temp, "temp difference" = mean_temp_diff, "coefficient of variance" = coeff_var) %>%
  kbl(caption = "Live North/South") %>%
  kable_classic(full_width = F, html_font = "Cambria") %>%
  kable_material("striped") %>%
  row_spec(0, hline_after = TRUE, extra_css = "border-bottom: 2px solid;") %>%
  row_spec(4, hline_after = TRUE, extra_css = "border-bottom: 2px solid;")

print(final_stats_monthly_ns_ub_table)
```

#### Charred/Uncharred/N/S GB Comparisons

Don't use the below code

```{r}
## dont use this!
#charred/uncharred monthly stas
stats_monthly_c_uc_V2 <- monthly_gb_data %>%
  #calculating monthly stats
  group_by(month, zone, burn_status) %>%
  summarize(c_uc_mean_temp = mean(c_uc_avg_temp), mean_diff = mean(c_uc_temp_diff), sd = sd(c_uc_temp_diff, na.rm = TRUE),
    coeff_var = (sd(c_uc_temp_diff, na.rm = TRUE) / abs(mean(c_uc_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate(across(where(is.numeric), round, 3))
```

#### GBDBUB Comparison

-   this small section is updated as of 2024-10-22

```{r}
monthly_gbdbub_data <- full_15min_gbdbub %>%
  group_by(month, zone) %>%
  summarize(mean_gb_temp = mean(gb_temp, na.rm = TRUE), mean_db_temp = mean(db_temp, na.rm = TRUE), mean_ub_temp = mean(ub_temp, na.rm = TRUE), gbdb_avg_temp = mean(gbdb_avg_temp, na.rm = TRUE), gbub_avg_temp = mean(gbub_avg_temp, na.rm = TRUE), dbub_avg_temp = mean(dbub_avg_temp, na.rm = TRUE), gbdb_temp_diff = mean(gbdb_temp_diff, na.rm = TRUE), gbub_temp_diff = mean(gbub_temp_diff, na.rm = TRUE), dbub_temp_diff = mean(dbub_temp_diff, na.rm = TRUE), .groups = 'drop')
```

```{r}
#making a stats dataframe with combined data did not work, so I am going to bind the already created gbdbub dataframes so I have a full gbdbub stats dataframe

#gb/db stats - db minus gb! - same as above no V1 version!
stats_monthly_gbdb <- full_15min_gbdbub %>%
  #calculating monthly stats
  group_by(month, zone, aspect) %>%
  summarize(gb_mean_temp = mean(gb_temp), db_mean_temp = mean(db_temp), gbdb_mean_temp = mean(gbdb_avg_temp), gbdb_mean_temp_diff = mean(gbdb_temp_diff), gbdb_sd = sd(gbdb_temp_diff, na.rm = TRUE),
    gbdb_coeff_var = (sd(gbdb_temp_diff, na.rm = TRUE) / abs(mean(gbdb_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3)
```

```{r}
#splitting by aspect for export
stats_monthly_gbdb_n <- stats_monthly_gbdb %>%
  filter(aspect == "north")

stats_monthly_gbdb_s <- stats_monthly_gbdb %>%
  filter(aspect == "south")
```

```{r}
#gb/ub stats - gb minus ub
stats_monthly_gbub <- full_15min_gbdbub %>%
  #calculating monthly stats
  group_by(month, zone, aspect) %>%
  summarize(gb_mean_temp = mean(gb_temp), ub_mean_temp = mean(ub_temp), gbub_mean_temp = mean(gbub_avg_temp), gbub_mean_temp_diff = mean(gbub_temp_diff), gbub_sd = sd(gbub_temp_diff, na.rm = TRUE),
    gbub_coeff_var = (sd(gbub_temp_diff, na.rm = TRUE) / abs(mean(gbub_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3)
```

```{r}
#splitting by aspect for export
stats_monthly_gbub_n <- stats_monthly_gbub %>%
  filter(aspect == "north")

stats_monthly_gbub_s <- stats_monthly_gbub %>%
  filter(aspect == "south")
```

```{r}
#db/ub stats - db minus ub
stats_monthly_dbub <- full_15min_gbdbub %>%
  #calculating monthly stats
  group_by(month, zone, aspect) %>%
  summarize(db_mean_temp = mean(db_temp), ub_mean_temp = mean(ub_temp), dbub_mean_temp = mean(dbub_avg_temp), dbub_mean_temp_diff = mean(dbub_temp_diff), dbub_sd = sd(dbub_temp_diff, na.rm = TRUE),
    dbub_coeff_var = (sd(dbub_temp_diff, na.rm = TRUE) / abs(mean(dbub_temp_diff, na.rm = TRUE)))) %>%
  #rounding numeric columns to 3 decimals
  mutate_if(is.numeric, round, 3)
```

```{r}
#splitting by aspect for export
stats_monthly_dbub_n <- stats_monthly_dbub %>%
  filter(aspect == "north")

stats_monthly_dbub_s <- stats_monthly_dbub %>%
  filter(aspect == "south")
```

Formatting GB DB UB tables - have not exported yet!

```{r}
#gbdb
final_stats_monthly_gbdb_table <- rbind(stats_monthly_gbdb_n, stats_monthly_gbdb_s) %>%
  rename("GB temp" = gb_mean_temp, "DB temp" = db_mean_temp, "mean temp" = gbdb_mean_temp, "mean temp difference" = gbdb_mean_temp_diff, "sd" = gbdb_sd, "coefficient of variance" = gbdb_coeff_var) %>%
  kbl() %>%
  kable_styling(html_font = "Cambria") %>%
  kable_material("striped")

final_stats_monthly_gbdb_table <- final_stats_monthly_gbdb_table %>%
  row_spec(8, extra_css = "border-bottom: 2px solid black;")

print(final_stats_monthly_gbdb_table)
```

```{r}
#gbub
final_stats_monthly_gbub_table <- rbind(stats_monthly_gbub_n, stats_monthly_gbub_s) %>%
  rename("GB temp" = gb_mean_temp, "UB temp" = ub_mean_temp, "mean temp" = gbub_mean_temp, "mean temp difference" = gbub_mean_temp_diff, "sd" = gbub_sd, "coefficient of variance" = gbub_coeff_var) %>%
  kbl() %>%
  kable_styling(html_font = "Cambria") %>%
  kable_material("striped")

final_stats_monthly_gbub_table <- final_stats_monthly_gbub_table %>%
  row_spec(8, extra_css = "border-bottom: 2px solid black;")

print(final_stats_monthly_gbub_table)
```

\*\* keep working on the above table formatting! - 2024.10.22

#### Saving New full stats as CSVs

These are full csv tables, not seperated by burn/unburned status

```{r}
write_csv(monthly_ns_data, "nsf/treetemp_data/monthly_ns_data.csv")

write_csv(stats_monthly_ns, "nsf/treetemp_data/stats_monthly_ns.csv")

write_csv(monthly_gbdbub_data, "nsf/treetemp_data/monthly_gbdbub_data.csv")

write_csv(stats_monthly_gbdbub, "nsf/treetemp_data/monthly_gbdbub_data.csv")
```

## Saving Stats CSV

### Exporting CSVs to N-drive

```{r}
write_csv(stats_monthly_ns_b, "nsf/treetemp_data/stats_monthly_ns_b.csv")

write_csv(stats_monthly_ns_ub, "nsf/treetemp_data/stats_monthly_ns_ub.csv")

write_csv(stats_monthly_ns_gb, "nsf/treetemp_data/stats_monthly_ns_gb.csv")

write_csv(stats_monthly_ns_db, "nsf/treetemp_data/stats_monthly_ns_db.csv")

write_csv(stats_monthly_gbdb, "nsf/treetemp_data/stats_monthly_gbdb.csv")

write_csv(stats_monthly_gbub, "nsf/treetemp_data/stats_monthly_gbub.csv")

write_csv(stats_monthly_dbub, "nsf/treetemp_data/stats_monthly_dbub.csv")

write_csv(stats_monthly_daynight, "nsf/treetemp_data/stats_monthly_daynight.csv")

#new charred/uncharred/n/s comparisons
write_csv(stats_monthly_c_uc, "nsf/treetemp_data/stats_montly_c_uc.csv")

write_csv(stats_monthly_s_c, "nsf/treetemp_data/stats_montly_s_c.csv")

write_csv(stats_monthly_s_uc, "nsf/treetemp_data/stats_montly_s_uc.csv")

write_csv(stats_monthly_n_c, "nsf/treetemp_data/stats_montly_n_c.csv")

write_csv(stats_monthly_n_uc, "nsf/treetemp_data/stats_montly_n_uc.csv")

#new gb/db/live n/s comparisons
write_csv(stats_monthly_ns_gb, "nsf/treetemp_data/stats_monthly_ns_gb.csv")

write_csv(stats_monthly_ns_db, "nsf/treetemp_data/stats_monthly_ns_db.csv")

write_csv(stats_monthly_ns_live, "nsf/treetemp_data/stats_monthly_ns_live.csv")
```

```{r}
write_csv(stats_monthly_s_n, "nsf/treetemp_data/stats_monthly_s_n.csv")
```

\*\*not using the below conversion process as of 2024-07-22, just adding csvs to word doc and turning into a table

# Converting CSVs to Tables

```{r}
#creating one NS table with subtitles of burned and unburned (seperate tables)

# Create HTML table with kable and kableExtra
ns_b_statstable <- kable(stats_monthly_ns_b, "html", caption = "Monthly Statistics of North and South Aspect Tree Temp Comparison, for Burned Zone") %>%
  kable_classic(full_width = F, html_font = "Cambria")

ns_ub_statstable <- kable(stats_monthly_ns_ub, "html", caption = "unburned") %>%
  kable_classic(full_width = F, html_font = "Cambria")

# Save the HTML tables to separate files
html_file_ns_b <- "ns_b_stats_table.html"
writeLines(as.character(ns_b_statstable), html_file_ns_b)

html_file_ns_ub <- "ns_ub_stats_table.html"
writeLines(as.character(ns_ub_statstable), html_file_ns_ub)

# Optionally, open the HTML files in the default web browser
browseURL(html_file_ns_b)
browseURL(html_file_ns_ub)
```

#the above process worked, but the html table doesn't look that good. Consider trying to make one large table, with all the sub tables included with sub-headers. That would work better I think?

# Plotting Temp Differences

```{r}

```

# Process to turn csv's into tables after exported

1.  Open CSV in Text Editor

2.  Copy all text

3.  Paste into Word Document

4.  highlight all text in word doc

5.  Click Tables \> Convert \> Convert text to table (make sure comma delimination is highlighted)

6.  Should appear as a table in the word document now

\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_

# Understanding the Statistics

When you calculate an average difference between two temperatures and analyze the percent difference, average, and coefficient of variation, each metric provides different insights into your data:

1.  **Percent Difference**:

    -   **What it tells you**: The percent difference gives you a relative measure of the difference between the two temperatures compared to their average. It tells you how large the difference is in relation to the overall magnitude of the temperatures.

    -   **Interpretation**: A high percent difference indicates a significant discrepancy between the two temperatures, whereas a low percent difference suggests that the temperatures are relatively similar.

2.  **Average**:

    -   **What it tells you**: The average temperature difference provides a measure of the central tendency of the differences between the two temperatures. It is the mean value of all the calculated differences.

    -   **Interpretation**: This metric gives you an idea of the typical or expected difference between the temperatures. It is useful for understanding the overall trend in the temperature differences.

3.  **Coefficient of Variation (CV)**:

    -   **What it tells you**: The coefficient of variation is a standardized measure of dispersion of the temperature differences. It is calculated as the ratio of the standard deviation to the mean and is usually expressed as a percentage.

    -   **Interpretation**: A high CV indicates that the temperature differences are highly variable, suggesting inconsistency or high variability in the temperature differences. A low CV indicates that the temperature differences are relatively consistent and stable.

### Example Scenario

Suppose you have two sets of temperature readings (in °C) from two different sensors or locations. After calculating the differences between the corresponding readings, you obtain the following statistics:

-   **Average Difference**: 2°C

-   **Percent Difference**: 10%

-   **Coefficient of Variation**: 25%

#### Interpretation:

-   **Average Difference**: On average, there is a 2°C difference between the temperatures recorded by the two sensors or at the two locations.

-   **Percent Difference**: The 10% difference indicates that the temperature difference is relatively small compared to the average temperature values of the readings.

-   **Coefficient of Variation**: A CV of 25% suggests moderate variability in the temperature differences. While there is some fluctuation in the differences, it is not extremely high, indicating that the differences are somewhat consistent but not entirely uniform.

In summary, these metrics together help you understand the magnitude, relative size, and variability of the temperature differences in your data.

## My Understanding of the Data

-   very high coefficient of variation and percent differences mean that there is a lot of variability of temperatures, even on a daily and monthly scale.

# T-Tests

Loading Data for tree temps

```{r}
pers_b_aspects <- read_csv("nsf/105E_pers_burned/105E_pers_b_aspects.csv") %>%
  mutate(datetime = force_tz(datetime, tz = 'MST'))

trans_b_aspects <- read_csv("nsf/105E_trans_burned/105E_trans_b_aspects.csv") %>%
  mutate(datetime = force_tz(datetime, tz = 'MST'))

pers_ub_aspects <- read_csv("nsf/105E_pers_unburned/105E_pers_ub_aspects.csv") %>%
  mutate(datetime = force_tz(datetime, tz = 'MST'))

trans_ub_aspects <- read_csv("nsf/105E_trans_unburned/105E_trans_ub_aspects.csv") %>%
  mutate(datetime = force_tz(datetime, tz = 'MST'))
```

Filtering dataframes for the purpose of temp comparisons

```{r}
filtered_pers_b_aspects <- pers_b_aspects %>%
  mutate(datetime = as.POSIXct(datetime, format = "%Y-%m-%d %H:%M:%S", tz = "MST")) %>%
  filter(datetime >= "2024-02-02 00:00:00" & datetime < "2024-07-01 00:00:00") %>%
  filter(tree_name != "gb_w") %>%
  mutate(snow_phase = if_else(datetime >= as.Date("2024-05-06"), "ablation", "accumulation"))

filtered_pers_ub_aspects <- pers_ub_aspects %>%
   mutate(datetime = as.POSIXct(datetime, format = "%Y-%m-%d %H:%M:%S", tz = "MST")) %>%
  filter(datetime >= "2024-02-02 00:00:00" & datetime < "2024-07-01 00:00:00") %>%
  mutate(snow_phase = if_else(datetime >= as.Date("2024-05-06"), "ablation", "accumulation"))

filtered_trans_b_aspects <- trans_b_aspects %>%
   mutate(datetime = as.POSIXct(datetime, format = "%Y-%m-%d %H:%M:%S", tz = "MST")) %>%
  filter(datetime >= "2024-02-02 00:00:00" & datetime < "2024-07-01 00:00:00") %>%
  mutate(snow_phase = if_else(datetime >= as.Date("2024-04-06"), "ablation", "accumulation"))

filtered_trans_ub_aspects <- trans_ub_aspects %>%
  mutate(datetime = as.POSIXct(datetime, format = "%Y-%m-%d %H:%M:%S", tz = "MST")) %>%
  filter(datetime >= "2024-02-02 00:00:00" & datetime < "2024-07-01 00:00:00") %>%
  mutate(snow_phase = if_else(datetime >= as.Date("2024-04-06"), "ablation", "accumulation"))
```

## T-Test Dataframes

### Green burned trees

```{r}
#using earlier dataframes to compare on a hourly timestep 
##testing with the hourly gb dataset - final_hourly_gb_temps

t_test_hourly_gb_s_n_result <- t.test(full_hourly_gb$south_temp, full_hourly_gb$north_temp)

print(t_test_hourly_gb_s_n_result)
```

-   above is statistically significant!

```{r}
t_test_hourly_gb_c_uc_result <- t.test(full_hourly_gb$charred_temp, full_hourly_gb$uncharred_temp)

print(t_test_hourly_gb_c_uc_result )
```

-   above is statistically significant

```{r}
t_test_hourly_gb_s_c_result <- t.test(final_hourly_gb_temps$mean_south_temp, final_hourly_gb_temps$mean_charred_temp)

print(t_test_hourly_gb_s_c_result)
```

-   above is NOT statistically significant

```{r}
t_test_hourly_gb_s_uc_result <- t.test(final_hourly_gb_temps$mean_south_temp, final_hourly_gb_temps$mean_uncharred_temp)

print(t_test_hourly_gb_s_uc_result)
```

-   Above is NOT statistically significant!

```{r}
t_test_hourly_gb_n_c_result <- t.test(final_hourly_gb_temps$mean_north_temp, final_hourly_gb_temps$mean_charred_temp)

print(t_test_hourly_gb_n_c_result)
```

-   above is statistically significant!

```{r}
t_test_hourly_gb_n_uc_result <- t.test(final_hourly_gb_temps$mean_north_temp, final_hourly_gb_temps$mean_uncharred_temp)

print(t_test_hourly_gb_n_uc_result)
```

-   above is NOT statistically significant!

Monthly GB T-Tests - to look at monthly trends

```{r}
#creating monthly dataframes
final_hourly_gb_temps <- final_hourly_gb_temps %>%
  mutate(datetime_hour = as.POSIXct(datetime_hour, format=("%Y-%m-%d %H:%M:%S")),
                               datetime_hour = force_tz(datetime_hour, tz = 'MST'))

feb_gb_data <- final_hourly_gb_temps %>%
  filter(month == "2")

march_gb_data <- final_hourly_gb_temps %>%
  filter(month == "3")

april_gb_data <- final_hourly_gb_temps %>%
  filter(month == "4")

may_gb_data <- final_hourly_gb_temps %>%
  filter(month == "5")
```

Monthly T-Tests to compare seasonal differences

Monthly GB N-S comparison

```{r}
t_test_feb_gb_s_n_result <- t.test(feb_gb_data$mean_south_temp, feb_gb_data$mean_north_temp)

print(t_test_feb_gb_s_n_result)
## above is every so slightly significant

t_test_march_gb_s_n_result <- t.test(march_gb_data$mean_south_temp, march_gb_data$mean_north_temp)

print(t_test_march_gb_s_n_result)
##above is significant

t_test_april_gb_s_n_result <- t.test(april_gb_data$mean_south_temp, april_gb_data$mean_north_temp)

print(t_test_april_gb_s_n_result)
## above is significant

t_test_may_gb_s_n_result <- t.test(may_gb_data$mean_south_temp, may_gb_data$mean_north_temp)

print(t_test_may_gb_s_n_result)
#above is not significant!
```

Monthly GB C-UC Comparison

```{r}
t_test_feb_gb_c_uc_result <- t.test(feb_gb_data$mean_charred_temp, feb_gb_data$mean_uncharred_temp)

print(t_test_feb_gb_c_uc_result)
## above is not significant

t_test_march_gb_c_uc_result <- t.test(march_gb_data$mean_charred_temp, march_gb_data$mean_uncharred_temp)

print(t_test_march_gb_c_uc_result)
## above is not significant

t_test_april_gb_c_uc_result <- t.test(april_gb_data$mean_charred_temp, april_gb_data$mean_uncharred_temp)

print(t_test_april_gb_c_uc_result)
## above is not significant? - p value = 0.03027

t_test_may_gb_c_uc_result <- t.test(may_gb_data$mean_charred_temp, may_gb_data$mean_uncharred_temp)

print(t_test_may_gb_c_uc_result)
## above is significant!
```

Monthly GB S-C comparison

```{r}
t_test_feb_gb_s_c_result <- t.test(feb_gb_data$mean_south_temp, feb_gb_data$mean_charred_temp)

print(t_test_feb_gb_s_c_result)
## above is not significant - 0.195

t_test_march_gb_s_c_result <- t.test(march_gb_data$mean_south_temp, march_gb_data$mean_charred_temp)

print(t_test_march_gb_s_c_result)
## above is not significant - 0.2871

t_test_april_gb_s_c_result <- t.test(april_gb_data$mean_south_temp, april_gb_data$mean_charred_temp)

print(t_test_april_gb_s_c_result)
## above is not significant - 0.4538

t_test_may_gb_s_c_result <- t.test(may_gb_data$mean_south_temp, may_gb_data$mean_charred_temp)

print(t_test_may_gb_s_c_result)
## above IS Significant! p = 0.002422
```

Monthly GB S-UC Comparison

```{r}
## none of these comparisons are significant

t_test_feb_gb_s_uc_result <- t.test(feb_gb_data$mean_south_temp, feb_gb_data$mean_uncharred_temp)

print(t_test_feb_gb_s_uc_result)
## above is not significant - 0.4534

t_test_march_gb_s_uc_result <- t.test(march_gb_data$mean_south_temp, march_gb_data$mean_uncharred_temp)

print(t_test_march_gb_s_uc_result)
## above is not significant - 0.2455

t_test_april_gb_s_uc_result <- t.test(april_gb_data$mean_south_temp, april_gb_data$mean_uncharred_temp)

print(t_test_april_gb_s_uc_result)
## above is not significant - 0.1629

t_test_may_gb_s_uc_result <- t.test(may_gb_data$mean_south_temp, may_gb_data$mean_uncharred_temp)

print(t_test_may_gb_s_uc_result)
## above is not significant - 0.4025
```

Monthly GB N-C comparison

```{r}
## all of these combinations are significant differences!

t_test_feb_gb_n_c_result <- t.test(feb_gb_data$mean_north_temp, feb_gb_data$mean_charred_temp)

print(t_test_feb_gb_n_c_result)
## above is not significant? - 0.086

t_test_march_gb_n_c_result <- t.test(march_gb_data$mean_north_temp, march_gb_data$mean_charred_temp)

print(t_test_march_gb_n_c_result)
## above is significant - 0.007399

t_test_april_gb_n_c_result <- t.test(april_gb_data$mean_north_temp, april_gb_data$mean_charred_temp)

print(t_test_april_gb_n_c_result)
## above is significant - 0.001116

t_test_may_gb_n_c_result <- t.test(may_gb_data$mean_north_temp, may_gb_data$mean_charred_temp)

print(t_test_may_gb_n_c_result)
## above IS Significant! p = 0.00265
```

Monthly GB N-UC Comparisons

```{r}
## none of these comparisons are significant

t_test_feb_gb_n_uc_result <- t.test(feb_gb_data$mean_north_temp, feb_gb_data$mean_uncharred_temp)

print(t_test_feb_gb_n_uc_result)
## above is significant? - 0.02531

t_test_march_gb_n_uc_result <- t.test(march_gb_data$mean_north_temp, march_gb_data$mean_uncharred_temp)

print(t_test_march_gb_n_uc_result)
## above is significant? - 0.01287

t_test_april_gb_n_uc_result <- t.test(april_gb_data$mean_north_temp, april_gb_data$mean_uncharred_temp)

print(t_test_april_gb_n_uc_result)
## above is not significant - 0.3065

t_test_may_gb_n_uc_result <- t.test(may_gb_data$mean_north_temp, may_gb_data$mean_uncharred_temp)

print(t_test_may_gb_n_uc_result)
## above is not significant - 0.3222
```

### Dead Burned Trees

\*\*

```{r}
#have to set up a new dataframe with pivoted wider values
final_hourly_db_temps <- full_hourly_ns %>%
  filter(burn_status == "dead burn") %>%
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  ))
```

```{r}
t_test_hourly_db_s_n_result <- t.test(final_hourly_db_temps$south_temp, final_hourly_db_temps$north_temp)

print(t_test_hourly_db_s_n_result)
```

Experimenting with facet wrapping and plotting data - DONT LIKE THIS! Not sure how to interpret it

```{r}
# Group by your variable (e.g., month) and run t-tests for each group
t_test_results <- final_hourly_db_temps %>%
  group_by(month, zone) %>%
  nest() %>%
  mutate(t_test = map(data, ~ tidy(t.test(.x$south_temp, .x$north_temp)))) %>%
  unnest(t_test)

# Plot the p-values or estimates and use facet_wrap for each group
ggplot(t_test_results, aes(x = month, y = estimate)) +
  geom_point() +
  facet_wrap(~ month) +  # Facet by the grouping variable
  labs(title = "T-test Results by Month", x = "Month", y = "Mean Difference in Temperature") +
  theme_minimal()
```

Monthly DB S-N comparisons

```{r}
#making monthly dataframes
feb_db_data <- final_hourly_db_temps %>%
  filter(month == "2")

march_db_data <- final_hourly_db_temps %>%
  filter(month == "3")

april_db_data <- final_hourly_db_temps %>%
  filter(month == "4")

may_db_data <- final_hourly_db_temps %>%
  filter(month == "5")
```

```{r}
t_test_feb_db_s_n_result <- t.test(feb_db_data$south_temp, feb_db_data$north_temp)

print(t_test_feb_db_s_n_result)
## above is significant

t_test_march_db_s_n_result <- t.test(march_db_data$south_temp, march_db_data$north_temp)

print(t_test_march_db_s_n_result)
##above is significant

t_test_april_db_s_n_result <- t.test(april_db_data$south_temp, april_db_data$north_temp)

print(t_test_april_db_s_n_result)
## above is significant

t_test_may_db_s_n_result <- t.test(may_db_data$south_temp, may_db_data$north_temp)

print(t_test_may_db_s_n_result)
#above is not significant
```

### Live Trees

```{r}
#have to set up a new dataframe with pivoted wider values
final_hourly_ub_temps <- full_hourly_ns %>%
  filter(burn_status == "live") %>%
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep other values unchanged
  ))
```

```{r}
t_test_hourly_ub_s_n_result <- t.test(final_hourly_ub_temps$south_temp, final_hourly_ub_temps$north_temp)

print(t_test_hourly_ub_s_n_result)
```

-   the above is significant!

Monthly live S-N comparisons

```{r}
#making monthly dataframes
feb_ub_data <- final_hourly_ub_temps %>%
  filter(month == "2")

march_ub_data <- final_hourly_ub_temps %>%
  filter(month == "3")

april_ub_data <- final_hourly_ub_temps %>%
  filter(month == "4")

may_ub_data <- final_hourly_ub_temps %>%
  filter(month == "5")
```

```{r}
t_test_feb_ub_s_n_result <- t.test(feb_ub_data$south_temp, feb_ub_data$north_temp)

print(t_test_feb_ub_s_n_result)
## above is significant

t_test_march_ub_s_n_result <- t.test(march_ub_data$south_temp, march_ub_data$north_temp)

print(t_test_march_ub_s_n_result)
##above is significant

t_test_april_ub_s_n_result <- t.test(april_ub_data$south_temp, april_ub_data$north_temp)

print(t_test_april_ub_s_n_result)
## above is significant

t_test_may_ub_s_n_result <- t.test(may_ub_data$south_temp, may_ub_data$north_temp)

print(t_test_may_ub_s_n_result)
#above is not significant
```

## Zone-specific T-Tests

### Green Burned

```{r}
#setting up dataframes
p_final_hourly_gb_temps <- full_hourly_gb %>%
  filter(zone == "PSZ")

t_final_hourly_gb_temps <- full_hourly_gb %>%
  filter(zone == "TSZ")

#N/S
p_t_test_hourly_gb_s_n_result <- t.test(p_final_hourly_gb_temps$south_temp, p_final_hourly_gb_temps$north_temp)

print(p_t_test_hourly_gb_s_n_result) 

t_t_test_hourly_gb_s_n_result <- t.test(t_final_hourly_gb_temps$south_temp, t_final_hourly_gb_temps$north_temp)

print(t_t_test_hourly_gb_s_n_result)
```

```{r}
#C/UC
p_t_test_hourly_gb_c_un_result <- t.test(p_final_hourly_gb_temps$charred_temp, p_final_hourly_gb_temps$uncharred_temp)

print(p_t_test_hourly_gb_c_un_result)

t_t_test_hourly_gb_c_un_result <- t.test(t_final_hourly_gb_temps$charred_temp, t_final_hourly_gb_temps$uncharred_temp)

print(t_t_test_hourly_gb_c_un_result)
```

```{r}
#S/C
p_t_test_hourly_gb_s_c_result <- t.test(p_final_hourly_gb_temps$south_temp, p_final_hourly_gb_temps$charred_temp)

print(p_t_test_hourly_gb_s_c_result)

t_t_test_hourly_gb_s_c_result <- t.test(t_final_hourly_gb_temps$south_temp, t_final_hourly_gb_temps$charred_temp)

print(t_t_test_hourly_gb_s_c_result)
```

```{r}
#S/UC
p_t_test_hourly_gb_s_uc_result <- t.test(p_final_hourly_gb_temps$south_temp, p_final_hourly_gb_temps$uncharred_temp)

print(p_t_test_hourly_gb_s_uc_result)

t_t_test_hourly_gb_s_uc_result <- t.test(t_final_hourly_gb_temps$south_temp, t_final_hourly_gb_temps$uncharred_temp)

print(t_t_test_hourly_gb_s_uc_result)
```

```{r}
#N/C
p_t_test_hourly_gb_n_c_result <- t.test(p_final_hourly_gb_temps$north_temp, p_final_hourly_gb_temps$charred_temp)

print(p_t_test_hourly_gb_n_c_result)

t_t_test_hourly_gb_n_c_result <- t.test(t_final_hourly_gb_temps$north_temp, t_final_hourly_gb_temps$charred_temp)

print(t_t_test_hourly_gb_n_c_result)
```

```{r}
#N/UC
p_t_test_hourly_gb_n_uc_result <- t.test(p_final_hourly_gb_temps$north_temp, p_final_hourly_gb_temps$uncharred_temp)

print(p_t_test_hourly_gb_n_uc_result)

t_t_test_hourly_gb_n_uc_result <- t.test(t_final_hourly_gb_temps$north_temp, t_final_hourly_gb_temps$uncharred_temp)

print(t_t_test_hourly_gb_n_uc_result)
```

Monthly GB S-N Comparison - by zone

```{r}
p_feb_gb_data <- full_hourly_gb %>%
  filter(zone == "PSZ", month == "2")

t_feb_gb_data <- full_hourly_gb %>%
  filter(zone == "TSZ", month == "2")

p_march_gb_data <- full_hourly_gb %>%
  filter(zone == "PSZ", month == "3")

t_march_gb_data <- full_hourly_gb %>%
  filter(zone == "TSZ", month == "3")

p_april_gb_data <- full_hourly_gb %>%
  filter(zone == "PSZ", month == "4")

t_april_gb_data <- full_hourly_gb %>%
  filter(zone == "TSZ", month == "4")

p_may_gb_data <- full_hourly_gb %>%
  filter(zone == "PSZ", month == "5")

t_may_gb_data <- full_hourly_gb %>%
  filter(zone == "TSZ", month == "5")
```

Monthly GB by zone

```{r}
#persistent monthly - N/S
p_t_test_feb_gb_s_n_result <- t.test(p_feb_gb_data$south_temp, p_feb_gb_data$north_temp)

print(p_t_test_feb_gb_s_n_result)
## above is not significant

p_t_test_march_gb_s_n_result <- t.test(p_march_gb_data$south_temp, p_march_gb_data$north_temp)

print(p_t_test_march_gb_s_n_result)
##above is not significant

p_t_test_april_gb_s_n_result <- t.test(p_april_gb_data$south_temp, p_april_gb_data$north_temp)

print(p_t_test_april_gb_s_n_result)
## above is not significant

p_t_test_may_gb_s_n_result <- t.test(p_may_gb_data$south_temp, p_may_gb_data$north_temp)

print(p_t_test_may_gb_s_n_result)
##above is not significant
```

```{r}
#transitional monthly - N/S
t_t_test_feb_gb_s_n_result <- t.test(t_feb_gb_data$south_temp, t_feb_gb_data$north_temp)

print(t_t_test_feb_gb_s_n_result)
## above is significant

t_t_test_march_gb_s_n_result <- t.test(t_march_gb_data$south_temp, t_march_gb_data$north_temp)

print(t_t_test_march_gb_s_n_result)
##above is significant

t_t_test_april_gb_s_n_result <- t.test(t_april_gb_data$south_temp, t_april_gb_data$north_temp)

print(t_t_test_april_gb_s_n_result)
## above is significant

t_t_test_may_gb_s_n_result <- t.test(t_may_gb_data$south_temp, t_may_gb_data$north_temp)

print(t_t_test_may_gb_s_n_result)
## above is not significant
```

Monthly S/C

```{r}
#persistent monthly - s/charred 
p_t_test_feb_gb_s_c_result <- t.test(p_feb_gb_data$south_temp, p_feb_gb_data$charred_temp)

print(p_t_test_feb_gb_s_c_result)
## above is not significant

p_t_test_march_gb_s_c_result <- t.test(p_march_gb_data$south_temp, p_march_gb_data$charred_temp)

print(p_t_test_march_gb_s_c_result)
## above is not significant

p_t_test_april_gb_s_c_result <- t.test(p_april_gb_data$south_temp, p_april_gb_data$charred_temp)

print(p_t_test_april_gb_s_c_result)
## above is significant

p_t_test_may_gb_s_c_result <- t.test(p_may_gb_data$south_temp, p_may_gb_data$charred_temp)

print(p_t_test_may_gb_s_c_result)
## above is significant
```

```{r}
#transitional monthly - s/charred 
t_t_test_feb_gb_s_c_result <- t.test(t_feb_gb_data$south_temp, t_feb_gb_data$charred_temp)

print(t_t_test_feb_gb_s_c_result)
## above is significant

t_t_test_march_gb_s_c_result <- t.test(t_march_gb_data$south_temp, t_march_gb_data$charred_temp)

print(t_t_test_march_gb_s_c_result)
## above is not significant

t_t_test_april_gb_s_c_result <- t.test(t_april_gb_data$south_temp, t_april_gb_data$charred_temp)

print(t_t_test_april_gb_s_c_result)
## above is not significant

t_t_test_may_gb_s_c_result <- t.test(t_may_gb_data$south_temp, t_may_gb_data$charred_temp)

print(t_t_test_may_gb_s_c_result)
## above is not significant
```

Monthly S/Uncharred

```{r}
#persistent monthly - s/uncharred 
p_t_test_feb_gb_s_uc_result <- t.test(p_feb_gb_data$south_temp, p_feb_gb_data$uncharred_temp)

print(p_t_test_feb_gb_s_uc_result)
## above is not significant

p_t_test_march_gb_s_uc_result <- t.test(p_march_gb_data$south_temp, p_march_gb_data$uncharred_temp)

print(p_t_test_march_gb_s_uc_result)
## above is not significant

p_t_test_april_gb_s_uc_result <- t.test(p_april_gb_data$south_temp, p_april_gb_data$uncharred_temp)

print(p_t_test_april_gb_s_uc_result)
## above is not significant

p_t_test_may_gb_s_uc_result <- t.test(p_may_gb_data$south_temp, p_may_gb_data$uncharred_temp)

print(p_t_test_may_gb_s_uc_result)
## above is not significant
```

```{r}
#transitional monthly - s/uncharred 
t_t_test_feb_gb_s_uc_result <- t.test(t_feb_gb_data$south_temp, t_feb_gb_data$uncharred_temp)

print(t_t_test_feb_gb_s_uc_result)
## above is not significant

t_t_test_march_gb_s_uc_result <- t.test(t_march_gb_data$south_temp, t_march_gb_data$uncharred_temp)

print(t_t_test_march_gb_s_uc_result)
## above is not significant

t_t_test_april_gb_s_uc_result <- t.test(t_april_gb_data$south_temp, t_april_gb_data$uncharred_temp)

print(t_t_test_april_gb_s_uc_result)
## above is not significant

t_t_test_may_gb_s_uc_result <- t.test(t_may_gb_data$south_temp, t_may_gb_data$uncharred_temp)

print(t_t_test_may_gb_s_uc_result)
## above is not significant
```

Monthly N/Charred

```{r}
#persistent monthly - n/charred 
p_t_test_feb_gb_n_c_result <- t.test(p_feb_gb_data$north_temp, p_feb_gb_data$charred_temp)

print(p_t_test_feb_gb_n_c_result)
## above is not significant

p_t_test_march_gb_n_c_result <- t.test(p_march_gb_data$north_temp, p_march_gb_data$charred_temp)

print(p_t_test_march_gb_n_c_result)
## above is not significant

p_t_test_april_gb_n_c_result <- t.test(p_april_gb_data$north_temp, p_april_gb_data$charred_temp)

print(p_t_test_april_gb_n_c_result)
## above is significant

p_t_test_may_gb_n_c_result <- t.test(p_may_gb_data$north_temp, p_may_gb_data$charred_temp)

print(p_t_test_may_gb_n_c_result)
## above is significant
```

```{r}
#transitional monthly - n/charred 
t_t_test_feb_gb_n_c_result <- t.test(t_feb_gb_data$north_temp, t_feb_gb_data$charred_temp)

print(t_t_test_feb_gb_n_c_result)
## above is significant

t_t_test_march_gb_n_c_result <- t.test(t_march_gb_data$north_temp, t_march_gb_data$charred_temp)

print(t_t_test_march_gb_n_c_result)
## above is not significant

t_t_test_april_gb_n_c_result <- t.test(t_april_gb_data$north_temp, t_april_gb_data$charred_temp)

print(t_t_test_april_gb_n_c_result)
## above is not significant

t_t_test_may_gb_n_c_result <- t.test(t_may_gb_data$north_temp, t_may_gb_data$charred_temp)

print(t_t_test_may_gb_n_c_result)
## above is not significant
```

Monthly North/Uncharred

```{r}
#persistent monthly - n/charred 
p_t_test_feb_gb_n_uc_result <- t.test(p_feb_gb_data$north_temp, p_feb_gb_data$uncharred_temp)

print(p_t_test_feb_gb_n_uc_result)
## above is not significant

p_t_test_march_gb_n_uc_result <- t.test(p_march_gb_data$north_temp, p_march_gb_data$uncharred_temp)

print(p_t_test_march_gb_n_uc_result)
## above is not significant

p_t_test_april_gb_n_uc_result <- t.test(p_april_gb_data$north_temp, p_april_gb_data$uncharred_temp)

print(p_t_test_april_gb_n_uc_result)
## above is significant

p_t_test_may_gb_n_uc_result <- t.test(p_may_gb_data$north_temp, p_may_gb_data$uncharred_temp)

print(p_t_test_may_gb_n_uc_result)
## above is significant
```

```{r}
#transitional monthly - n/uncharred 
t_t_test_feb_gb_n_uc_result <- t.test(t_feb_gb_data$north_temp, t_feb_gb_data$uncharred_temp)

print(t_t_test_feb_gb_n_uc_result)
## above is significant

t_t_test_march_gb_n_uc_result <- t.test(t_march_gb_data$north_temp, t_march_gb_data$uncharred_temp)

print(t_t_test_march_gb_n_uc_result)
## above is not significant

t_t_test_april_gb_n_uc_result <- t.test(t_april_gb_data$north_temp, t_april_gb_data$uncharred_temp)

print(t_t_test_april_gb_n_uc_result)
## above is not significant

t_t_test_may_gb_n_uc_result <- t.test(t_may_gb_data$north_temp, t_may_gb_data$uncharred_temp)

print(t_t_test_may_gb_n_uc_result)
## above is not significant
```

Monthly Charred/Uncharred

```{r}
#persistent monthly - charred /uncharred
p_t_test_feb_gb_c_uc_result <- t.test(p_feb_gb_data$charred_temp, p_feb_gb_data$uncharred_temp)

print(p_t_test_feb_gb_c_uc_result)
## above is not significant

p_t_test_march_gb_c_uc_result <- t.test(p_march_gb_data$charred_temp, p_march_gb_data$uncharred_temp)

print(p_t_test_march_gb_c_uc_result)
## above is not significant

p_t_test_april_gb_c_uc_result <- t.test(p_april_gb_data$charred_temp, p_april_gb_data$uncharred_temp)

print(p_t_test_april_gb_c_uc_result)
## above is significant

p_t_test_may_gb_c_uc_result <- t.test(p_may_gb_data$charred_temp, p_may_gb_data$uncharred_temp)

print(p_t_test_may_gb_c_uc_result)
## above is significant
```

```{r}
#transitional monthly - charred/uncharred 
t_t_test_feb_gb_c_uc_result <- t.test(t_feb_gb_data$charred_temp, t_feb_gb_data$uncharred_temp)

print(t_t_test_feb_gb_c_uc_result)
## above is significant

t_t_test_march_gb_c_uc_result <- t.test(t_march_gb_data$charred_temp, t_march_gb_data$uncharred_temp)

print(t_t_test_march_gb_c_uc_result)
## above is not significant

t_t_test_april_gb_c_uc_result <- t.test(t_april_gb_data$charred_temp, t_april_gb_data$uncharred_temp)

print(t_t_test_april_gb_c_uc_result)
## above is not significant

t_t_test_may_gb_c_uc_result <- t.test(t_may_gb_data$charred_temp, t_may_gb_data$uncharred_temp)

print(t_t_test_may_gb_c_uc_result)
## above is not significant
```

### Dead Burned

```{r}
p_final_hourly_db_temps <- full_hourly_ns %>%
  filter(zone == "persistent", burn_status == "dead burn") %>%
  mutate(zone = "PSZ")

t_final_hourly_db_temps <- full_hourly_ns %>%
  filter(zone == "transitional", burn_status == "dead burn") %>%
  mutate(zone = "TSZ")
```

```{r}

p_t_test_hourly_db_s_n_result <- t.test(p_final_hourly_db_temps$south_temp, p_final_hourly_db_temps$north_temp)

print(p_t_test_hourly_db_s_n_result)

t_t_test_hourly_db_s_n_result <- t.test(t_final_hourly_db_temps$south_temp, t_final_hourly_db_temps$north_temp)

print(t_t_test_hourly_db_s_n_result)
```

Monthly DB S-N Comparisons by zone

```{r}
#dataframes
p_feb_db_data <- p_final_hourly_db_temps %>%
  filter(month == "2")

t_feb_db_data <- t_final_hourly_db_temps %>%
  filter(month == "2")

p_march_db_data <- p_final_hourly_db_temps %>%
  filter(month == "3")

t_march_db_data <- t_final_hourly_db_temps %>%
  filter(month == "3")

p_april_db_data <- p_final_hourly_db_temps %>%
  filter(month == "4")

t_april_db_data <- t_final_hourly_db_temps %>%
  filter(month == "4")

p_may_db_data <- p_final_hourly_db_temps %>%
  filter(month == "5")

t_may_db_data <- t_final_hourly_db_temps %>%
  filter(month == "5")
```

Persistent

```{r}
p_t_test_feb_db_s_n_result <- t.test(p_feb_db_data$south_temp, p_feb_db_data$north_temp)

print(p_t_test_feb_db_s_n_result)
## above is significant

p_t_test_march_db_s_n_result <- t.test(p_march_db_data$south_temp, p_march_db_data$north_temp)

print(p_t_test_march_db_s_n_result)
##above is significant

p_t_test_april_db_s_n_result <- t.test(p_april_db_data$south_temp, p_april_db_data$north_temp)

print(p_t_test_april_db_s_n_result)
## above is significant

p_t_test_may_db_s_n_result <- t.test(p_may_db_data$south_temp, p_may_db_data$north_temp)

print(p_t_test_may_db_s_n_result)
#above is not significant
```

Transitional

```{r}
t_t_test_feb_db_s_n_result <- t.test(t_feb_db_data$south_temp, t_feb_db_data$north_temp)

print(t_t_test_feb_db_s_n_result)
## above is significant

t_t_test_march_db_s_n_result <- t.test(t_march_db_data$south_temp, t_march_db_data$north_temp)

print(t_t_test_march_db_s_n_result)
##above is significant

t_t_test_april_db_s_n_result <- t.test(t_april_db_data$south_temp, t_april_db_data$north_temp)

print(t_t_test_april_db_s_n_result)
## above is significant

t_t_test_may_db_s_n_result <- t.test(t_may_db_data$south_temp, t_may_db_data$north_temp)

print(t_t_test_may_db_s_n_result)
#above is not significant
```

### Live

```{r}
p_final_hourly_ub_temps <- full_hourly_ns %>%
  filter(zone == "persistent", burn_status == "live") %>%
  mutate(zone = "PSZ")

t_final_hourly_ub_temps <- full_hourly_ns %>%
  filter(zone == "transitional", burn_status == "live") %>%
  mutate(zone = "TSZ")

p_t_test_hourly_ub_s_n_result <- t.test(p_final_hourly_ub_temps$south_temp, p_final_hourly_ub_temps$north_temp)

print(p_t_test_hourly_ub_s_n_result)

t_t_test_hourly_ub_s_n_result <- t.test(t_final_hourly_ub_temps$south_temp, t_final_hourly_ub_temps$north_temp)

print(t_t_test_hourly_ub_s_n_result)
```

Monthly Live S-N Comparisons by zone

```{r}
#dataframes
p_feb_ub_data <- p_final_hourly_ub_temps %>%
  filter(month == "2")

t_feb_ub_data <- t_final_hourly_ub_temps %>%
  filter(month == "2")

p_march_ub_data <- p_final_hourly_ub_temps %>%
  filter(month == "3")

t_march_ub_data <- t_final_hourly_ub_temps %>%
  filter(month == "3")

p_april_ub_data <- p_final_hourly_ub_temps %>%
  filter(month == "4")

t_april_ub_data <- t_final_hourly_ub_temps %>%
  filter(month == "4")

p_may_ub_data <- p_final_hourly_ub_temps %>%
  filter(month == "5")

t_may_ub_data <- t_final_hourly_ub_temps %>%
  filter(month == "5")
```

Persistent

```{r}
p_t_test_feb_ub_s_n_result <- t.test(p_feb_ub_data$south_temp, p_feb_ub_data$north_temp)

print(p_t_test_feb_ub_s_n_result)
## above is not significant

p_t_test_march_ub_s_n_result <- t.test(p_march_ub_data$south_temp, p_march_ub_data$north_temp)

print(p_t_test_march_ub_s_n_result)
##above is not significant

p_t_test_april_ub_s_n_result <- t.test(p_april_ub_data$south_temp, p_april_ub_data$north_temp)

print(p_t_test_april_ub_s_n_result)
## above is not significant

p_t_test_may_ub_s_n_result <- t.test(p_may_ub_data$south_temp, p_may_ub_data$north_temp)

print(p_t_test_may_ub_s_n_result)
#above is not significant
```

transitional

```{r}
t_t_test_feb_ub_s_n_result <- t.test(t_feb_ub_data$south_temp, t_feb_ub_data$north_temp)

print(t_t_test_feb_ub_s_n_result)
## above is significant

t_t_test_march_ub_s_n_result <- t.test(t_march_ub_data$south_temp, t_march_ub_data$north_temp)

print(t_t_test_march_ub_s_n_result)
##above is significant

t_t_test_april_ub_s_n_result <- t.test(t_april_ub_data$south_temp, t_april_ub_data$north_temp)

print(t_t_test_april_ub_s_n_result)
## above is significant

t_t_test_may_ub_s_n_result <- t.test(t_may_ub_data$south_temp, t_may_ub_data$north_temp)

print(t_t_test_may_ub_s_n_result)
#above is not significant
```

### DB vs GB vs UB N/S test

\*\* need to run these tests

```{r}
#zone-specific tests
p_n_full_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "PSZ", aspect == "north")

p_s_full_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "PSZ", aspect == "south")

t_n_full_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "TSZ", aspect == "north")

t_s_full_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "TSZ", aspect == "south")
```

```{r}
#by accumulation/ablation
#zone-specific tests
p_n_accu_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "PSZ", aspect == "north") %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )) %>%
  filter(snow_phase == "accumulation")

p_s_accu_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "PSZ", aspect == "south") %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )) %>%
  filter(snow_phase == "accumulation")

t_n_accu_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "TSZ", aspect == "north") %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )) %>%
  filter(snow_phase == "accumulation")

t_s_accu_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "TSZ", aspect == "south") %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )) %>%
  filter(snow_phase == "accumulation")
```

```{r}
p_n_abla_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "PSZ", aspect == "north") %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )) %>%
  filter(snow_phase == "ablation")

p_s_abla_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "PSZ", aspect == "south") %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )) %>%
  filter(snow_phase == "ablation")

t_n_abla_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "TSZ", aspect == "north") %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )) %>%
  filter(snow_phase == "ablation")

t_s_abla_hourly_gbdbub <- full_hourly_gbdbub %>%
  filter(zone == "TSZ", aspect == "south") %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )) %>%
  filter(snow_phase == "ablation")
```

```{r}
#GB/DB T-test
## north
p_t_test_hourly_n_gbdb_result <- t.test(p_n_full_hourly_gbdbub$gb_temp, p_n_full_hourly_gbdbub$db_temp)

print(p_t_test_hourly_n_gbdb_result)

t_t_test_hourly_n_gbdb_result <- t.test(t_n_full_hourly_gbdbub$gb_temp, t_n_full_hourly_gbdbub$db_temp)

print(t_t_test_hourly_n_gbdb_result)

##south
p_t_test_hourly_s_gbdb_result <- t.test(p_s_full_hourly_gbdbub$gb_temp, p_s_full_hourly_gbdbub$db_temp)

print(p_t_test_hourly_s_gbdb_result)

t_t_test_hourly_s_gbdb_result <- t.test(t_s_full_hourly_gbdbub$gb_temp, t_s_full_hourly_gbdbub$db_temp)

print(t_t_test_hourly_s_gbdb_result)
```

```{r}
#GB/DB T-test by accumulation/abalation

p_t_test_hourly_n_accu_gbdb_result <- t.test(p_n_accu_hourly_gbdbub$gb_temp, p_n_accu_hourly_gbdbub$db_temp)

print(p_t_test_hourly_n_accu_gbdb_result)

t_t_test_hourly_n_accu_gbdb_result <- t.test(t_n_accu_hourly_gbdbub$gb_temp, t_n_accu_hourly_gbdbub$db_temp)

print(t_t_test_hourly_n_accu_gbdb_result)

##south
p_t_test_hourly_s_accu_gbdb_result <- t.test(p_s_accu_hourly_gbdbub$gb_temp, p_s_accu_hourly_gbdbub$db_temp)

print(p_t_test_hourly_s_accu_gbdb_result)

t_t_test_hourly_s_accu_gbdb_result <- t.test(t_s_accu_hourly_gbdbub$gb_temp, t_s_accu_hourly_gbdbub$db_temp)

print(t_t_test_hourly_s_accu_gbdb_result)
```

```{r}
#GB/live T-test
## north
p_t_test_hourly_n_accu_gbub_result <- t.test(p_n_accu_hourly_gbdbub$gb_temp, p_n_accu_hourly_gbdbub$ub_temp)

print(p_t_test_hourly_n_accu_gbub_result)

t_t_test_hourly_n_accu_gbub_result <- t.test(t_n_accu_hourly_gbdbub$gb_temp, t_n_accu_hourly_gbdbub$ub_temp)

print(t_t_test_hourly_n_accu_gbub_result)

##south
p_t_test_hourly_s_accu_gbub_result <- t.test(p_s_accu_hourly_gbdbub$gb_temp, p_s_accu_hourly_gbdbub$ub_temp)

print(p_t_test_hourly_s_accu_gbub_result)

t_t_test_hourly_s_accu_gbub_result <- t.test(t_s_accu_hourly_gbdbub$gb_temp, t_s_accu_hourly_gbdbub$ub_temp)

print(t_t_test_hourly_s_accu_gbub_result)
```

```{r}
#DB/live T-test
## north
p_t_test_hourly_n_accu_dbub_result <- t.test(p_n_accu_hourly_gbdbub$db_temp, p_n_accu_hourly_gbdbub$ub_temp)

print(p_t_test_hourly_n_accu_dbub_result)

t_t_test_hourly_n_accu_dbub_result <- t.test(t_n_accu_hourly_gbdbub$db_temp, t_n_accu_hourly_gbdbub$ub_temp)

print(t_t_test_hourly_n_accu_dbub_result)

##south
p_t_test_hourly_s_accu_dbub_result <- t.test(p_s_accu_hourly_gbdbub$db_temp, p_s_accu_hourly_gbdbub$ub_temp)

print(p_t_test_hourly_s_accu_dbub_result)

t_t_test_hourly_s_accu_dbub_result <- t.test(t_s_accu_hourly_gbdbub$db_temp, t_s_accu_hourly_gbdbub$ub_temp)

print(t_t_test_hourly_s_accu_dbub_result)
```

## Day/Night T-Tests

-   Don't actually need to do t-tests on these because it's already known that there is a significant difference!

```{r}
#GB dataframe with daily averaged day and night temperatures
gb_daynight_ns_temps <- full_15min_gbdbub %>%
  rename(date = day) %>%
  group_by(date, month, phase, zone, aspect) %>%
  summarize(gb_temp = mean(gb_temp)) %>%
  pivot_wider(names_from = phase, values_from = gb_temp) %>%
  rename(day_temp = day, night_temp = night)

#PSZ
p_gb_daynight_ns_temps <- gb_daynight_ns_temps %>%
  filter(zone == "PSZ")

p_n_gb_daynight_temps <- p_gb_daynight_ns_temps %>%
  filter(aspect == "north")

p_s_gb_daynight_temps <- p_gb_daynight_ns_temps %>%
  filter(aspect == "south")

#TSZ
t_gb_daynight_ns_temps <- gb_daynight_ns_temps %>%
  filter(zone == "TSZ")

t_n_gb_daynight_temps <- t_gb_daynight_ns_temps %>%
  filter(aspect == "north")

t_s_gb_daynight_temps <- t_gb_daynight_ns_temps %>%
  filter(aspect == "south")
```

```{r}
#DB dataframe with daily averaged day and night temperatures
db_daynight_ns_temps <- full_hourly_gbdbub %>%
  select(1:6, 8) %>%
  rename(date = day) %>%
  group_by(date, month, phase, zone, aspect) %>%
  summarize(db_temp = mean(db_temp)) %>%
  pivot_wider(names_from = phase, values_from = db_temp) %>%
  rename(day_temp = day, night_temp = night)

#PSZ
p_db_daynight_ns_temps <- db_daynight_ns_temps %>%
  filter(zone == "PSZ")

p_n_db_daynight_temps <- p_db_daynight_ns_temps %>%
  filter(aspect == "north")

p_s_db_daynight_temps <- p_db_daynight_ns_temps %>%
  filter(aspect == "south")

#TSZ
t_db_daynight_ns_temps <- db_daynight_ns_temps %>%
  filter(zone == "TSZ")

t_n_db_daynight_temps <- t_db_daynight_ns_temps %>%
  filter(aspect == "north")


t_s_db_daynight_temps <- t_db_daynight_ns_temps %>%
  filter(aspect == "south")
```

```{r}
#UB dataframe with daily averaged day and night temperatures
ub_daynight_ns_temps <- full_hourly_gbdbub %>%
  select(1:6, 9) %>%
  rename(date = day) %>%
  group_by(date, month, phase, zone, aspect) %>%
  summarize(ub_temp = mean(ub_temp)) %>%
  pivot_wider(names_from = phase, values_from = ub_temp) %>%
  rename(day_temp = day, night_temp = night)

#PSZ
p_ub_daynight_ns_temps <- ub_daynight_ns_temps %>%
  filter(zone == "PSZ")

p_n_ub_daynight_temps <- p_ub_daynight_ns_temps %>%
  filter(aspect == "north")

p_s_ub_daynight_temps <- p_ub_daynight_ns_temps %>%
  filter(aspect == "south")

#TSZ
t_ub_daynight_ns_temps <- ub_daynight_ns_temps %>%
  filter(zone == "TSZ")

t_n_ub_daynight_temps <- t_ub_daynight_ns_temps %>%
  filter(aspect == "north")

t_s_ub_daynight_temps <- t_ub_daynight_ns_temps %>%
  filter(aspect == "south")
```

Welch's T-Tests

```{r}
#GB
##north
p_t_test_n_gb_daynight_temps <- t.test(p_n_gb_daynight_temps$day_temp, p_n_gb_daynight_temps$night_temp)

print(p_t_test_n_gb_daynight_temps)

t_t_test_n_gb_daynight_temps <- t.test(t_n_gb_daynight_temps$day_temp, t_n_gb_daynight_temps$night_temp)

print(t_t_test_n_gb_daynight_temps)

##south
p_t_test_s_gb_daynight_temps <- t.test(p_s_gb_daynight_temps$day_temp, p_s_gb_daynight_temps$night_temp)

print(p_t_test_s_gb_daynight_temps)

t_t_test_s_gb_daynight_temps <- t.test(t_s_gb_daynight_temps$day_temp, t_s_gb_daynight_temps$night_temp)

print(t_t_test_s_gb_daynight_temps)
```

```{r}
#DB
##north
p_t_test_n_db_daynight_temps <- t.test(p_n_db_daynight_temps$day_temp, p_n_db_daynight_temps$night_temp)

print(p_t_test_n_db_daynight_temps)

t_t_test_n_db_daynight_temps <- t.test(t_n_db_daynight_temps$day_temp, t_n_db_daynight_temps$night_temp)

print(t_t_test_n_db_daynight_temps)

##south
p_t_test_s_db_daynight_temps <- t.test(p_s_db_daynight_temps$day_temp, p_s_db_daynight_temps$night_temp)

print(p_t_test_s_db_daynight_temps)

t_t_test_s_db_daynight_temps <- t.test(t_s_db_daynight_temps$day_temp, t_s_db_daynight_temps$night_temp)

print(t_t_test_s_db_daynight_temps)
```

```{r}
#UB
##north
p_t_test_n_ub_daynight_temps <- t.test(p_n_ub_daynight_temps$day_temp, p_n_ub_daynight_temps$night_temp)

print(p_t_test_n_ub_daynight_temps)

t_t_test_n_ub_daynight_temps <- t.test(t_n_ub_daynight_temps$day_temp, t_n_ub_daynight_temps$night_temp)

print(t_t_test_n_ub_daynight_temps)

##south
p_t_test_s_ub_daynight_temps <- t.test(p_s_ub_daynight_temps$day_temp, p_s_ub_daynight_temps$night_temp)

print(p_t_test_s_ub_daynight_temps)

t_t_test_s_ub_daynight_temps <- t.test(t_s_ub_daynight_temps$day_temp, t_s_ub_daynight_temps$night_temp)

print(t_t_test_s_ub_daynight_temps)
```

## Ablation vs Accumulation T-Test

GB Trees

```{r}
p_accum_gb_data <- full_15min_ns %>%
  filter(zone == "PSZ", snow_phase == "accumulation", burn_status == "green burn")

p_abla_gb_data <- full_15min_ns %>%
  filter(zone == "PSZ", snow_phase == "ablation", burn_status == "green burn")

t_accum_gb_data <- full_15min_ns %>%
  filter(zone == "PSZ", snow_phase == "accumulation", burn_status == "green burn")

t_abla_gb_data <- full_15min_ns %>%
  filter(zone == "PSZ", snow_phase == "ablation", burn_status == "green burn")
```

```{r}
#persistent accumulation - N/S
p_ttest_accum_gb_s_n_results <- t.test(p_accum_gb_data $south_temp, p_accum_gb_data$north_temp)

print(p_ttest_accum_gb_s_n_results)
```

```{r}
#persistent ablation - N/S
p_ttest_abla_gb_s_n_results <- t.test(p_abla_gb_data $south_temp, p_abla_gb_data$north_temp)

print(p_ttest_abla_gb_s_n_results)
```

```{r}
#transitional accumulation - N/S
t_ttest_accum_gb_s_n_results <- t.test(t_accum_gb_data $south_temp, t_accum_gb_data$north_temp)

print(t_ttest_accum_gb_s_n_results)
```

```{r}
#transitional ablation - N/S
t_ttest_abla_gb_s_n_results <- t.test(t_abla_gb_data $south_temp, t_abla_gb_data$north_temp)

print(t_ttest_abla_gb_s_n_results)
```

DB N-S

```{r}
p_accum_db_data <- full_15min_ns %>%
  filter(zone == "PSZ", snow_phase == "accumulation", burn_status == "dead burn")

p_abla_db_data <- full_15min_ns %>%
  filter(zone == "PSZ", snow_phase == "ablation", burn_status == "dead burn")

t_accum_db_data <- full_15min_ns %>%
  filter(zone == "TSZ", snow_phase == "accumulation", burn_status == "dead burn")

t_abla_db_data <- full_15min_ns %>%
  filter(zone == "TSZ", snow_phase == "ablation",  burn_status == "dead burn")
```

```{r}
#persistent accumulation - N/S
p_ttest_accum_db_s_n_results <- t.test(p_accum_db_data $south_temp, p_accum_db_data$north_temp)

print(p_ttest_accum_db_s_n_results)
```

```{r}
#persistent ablation- N/S
p_ttest_abla_db_s_n_results <- t.test(p_abla_db_data $south_temp, p_abla_db_data$north_temp)

print(p_ttest_abla_db_s_n_results)
```

```{r}
#transitional accumulation - N/S
t_ttest_accum_db_s_n_results <- t.test(t_accum_db_data $south_temp, t_accum_db_data$north_temp)

print(t_ttest_accum_db_s_n_results)
```

```{r}
#transitional ablation - N/S
t_ttest_abla_db_s_n_results <- t.test(t_abla_db_data $south_temp, t_abla_db_data$north_temp)

print(t_ttest_abla_db_s_n_results)
```

Live - N/S

```{r}
p_accum_live_data <- full_15min_ns %>%
  filter(zone == "PSZ", snow_phase == "accumulation", burn_status == "live")

p_abla_live_data <- full_15min_ns %>%
  filter(zone == "PSZ", snow_phase == "ablation", burn_status == "live")

t_accum_live_data <- full_15min_ns %>%
  filter(zone == "TSZ", snow_phase == "accumulation", burn_status == "live")

t_abla_live_data <- full_15min_ns %>%
  filter(zone == "TSZ", snow_phase == "ablation",  burn_status == "live")
```

```{r}
#persistent accumulation - N/S
p_ttest_accum_live_s_n_results <- t.test(p_accum_live_data $south_temp, p_accum_live_data$north_temp)

print(p_ttest_accum_live_s_n_results)
```

```{r}
#persistent ablation - N/S
p_ttest_abla_live_s_n_results <- t.test(p_abla_live_data $south_temp, p_abla_live_data$north_temp)

print(p_ttest_abla_live_s_n_results)
```

```{r}
#transitional accumulation - N/S
t_ttest_accum_live_s_n_results <- t.test(t_accum_live_data $south_temp, t_accum_live_data$north_temp)

print(t_ttest_accum_live_s_n_results)
```

```{r}
#transitional ablation - N/S
t_ttest_abla_live_s_n_results <- t.test(t_abla_live_data $south_temp, t_abla_live_data$north_temp)

print(t_ttest_abla_live_s_n_results)
```

\*\* The above analysis does show somewhat of a pattern that is easier to interpret!

GB vs DB vs Live

```{r}
p_n_accu_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "PSZ", aspect == "north", snow_phase == "accumulation")

p_n_abla_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "PSZ", aspect == "north", snow_phase == "ablation")

t_n_accu_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "TSZ", aspect == "north", snow_phase == "accumulation")

t_n_abla_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "TSZ", aspect == "north", snow_phase == "ablation")
```

```{r}
p_s_accu_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "PSZ", aspect == "south", snow_phase == "accumulation")

p_s_abla_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "PSZ", aspect == "south", snow_phase == "ablation")

t_s_accu_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "TSZ", aspect == "south", snow_phase == "accumulation")

t_s_abla_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "TSZ", aspect == "south", snow_phase == "ablation")
```

GB vs DB - N

```{r}
#persistent accumulation - GB vs DB
p_ttest_accum_gb_db_n_results <- t.test(p_n_accu_gbdbub $gb_temp, p_n_accu_gbdbub$db_temp)

print(p_ttest_accum_gb_db_n_results)

p_ttest_abla_gb_db_n_results <- t.test(p_n_abla_gbdbub $gb_temp, p_n_abla_gbdbub$db_temp)

print(p_ttest_abla_gb_db_n_results)
```

```{r}
#transitional accumulation - GB vs DB
t_ttest_accum_gb_db_n_results <- t.test(t_n_accu_gbdbub $gb_temp, t_n_accu_gbdbub$db_temp)

print(t_ttest_accum_gb_db_n_results)

t_ttest_abla_gb_db_n_results <- t.test(t_n_abla_gbdbub $gb_temp, t_n_abla_gbdbub$db_temp)

print(t_ttest_abla_gb_db_n_results)
```

GB vs DB - S

```{r}
#persistent accumulation - GB vs DB
p_ttest_accum_gb_db_s_results <- t.test(p_s_accu_gbdbub $gb_temp, p_s_accu_gbdbub$db_temp)

print(p_ttest_accum_gb_db_s_results)

p_ttest_abla_gb_db_s_results <- t.test(p_s_abla_gbdbub $gb_temp, p_s_abla_gbdbub$db_temp)

print(p_ttest_abla_gb_db_s_results)
```

```{r}
#transitional accumulation - GB vs DB
t_ttest_accum_gb_db_s_results <- t.test(t_s_accu_gbdbub $gb_temp, t_s_accu_gbdbub$db_temp)

print(t_ttest_accum_gb_db_s_results)

t_ttest_abla_gb_db_s_results <- t.test(t_s_abla_gbdbub $gb_temp, t_s_abla_gbdbub$db_temp)

print(t_ttest_abla_gb_db_s_results)
```

GB vs Live - N

```{r}
#persistent accumulation - GB vs Live North
p_ttest_accum_gb_live_n_results <- t.test(p_n_accu_gbdbub $gb_temp, p_n_accu_gbdbub$ub_temp)

print(p_ttest_accum_gb_live_n_results)

p_ttest_abla_gb_live_n_results <- t.test(p_n_abla_gbdbub $gb_temp, p_n_abla_gbdbub$ub_temp)

print(p_ttest_abla_gb_live_n_results)
```

```{r}
#transitional accumulation - GB vs Live North
t_ttest_accum_gb_live_n_results <- t.test(t_n_accu_gbdbub $gb_temp, t_n_accu_gbdbub$ub_temp)

print(t_ttest_accum_gb_live_n_results)

t_ttest_abla_gb_live_n_results <- t.test(t_n_abla_gbdbub $gb_temp, t_n_abla_gbdbub$ub_temp)

print(t_ttest_abla_gb_live_n_results)
```

GB vs Live - S

```{r}
#persistent accumulation - GB vs Live South
p_ttest_accum_gb_live_s_results <- t.test(p_s_accu_gbdbub $gb_temp, p_s_accu_gbdbub$ub_temp)

print(p_ttest_accum_gb_live_s_results)

p_ttest_abla_gb_live_s_results <- t.test(p_s_abla_gbdbub $gb_temp, p_s_abla_gbdbub$ub_temp)

print(p_ttest_abla_gb_live_s_results)
```

```{r}
#transitional accumulation - GB vs Live South
t_ttest_accum_gb_live_s_results <- t.test(t_s_accu_gbdbub $gb_temp, t_s_accu_gbdbub$ub_temp)

print(t_ttest_accum_gb_live_s_results)

t_ttest_abla_gb_live_s_results <- t.test(t_s_abla_gbdbub $gb_temp, t_s_abla_gbdbub$ub_temp)

print(t_ttest_abla_gb_live_s_results)
```

DB vs Live - N

```{r}
#persistent accumulation - DB vs Live North
p_ttest_accum_db_live_n_results <- t.test(p_n_accu_gbdbub $db_temp, p_n_accu_gbdbub$ub_temp)

print(p_ttest_accum_db_live_n_results)

p_ttest_abla_db_live_n_results <- t.test(p_n_abla_gbdbub $db_temp, p_n_abla_gbdbub$ub_temp)

print(p_ttest_abla_db_live_n_results)
```

```{r}
#transitional accumulation - DB vs Live North
t_ttest_accum_db_live_n_results <- t.test(t_n_accu_gbdbub $db_temp, t_n_accu_gbdbub$ub_temp)

print(t_ttest_accum_db_live_n_results)

t_ttest_abla_db_live_n_results <- t.test(t_n_abla_gbdbub $db_temp, t_n_abla_gbdbub$ub_temp)

print(t_ttest_abla_db_live_n_results)
```

DB vs Live - S

```{r}
#persistent accumulation - DB vs Live South
p_ttest_accum_db_live_s_results <- t.test(p_s_accu_gbdbub $db_temp, p_s_accu_gbdbub$ub_temp)

print(p_ttest_accum_db_live_s_results)

p_ttest_abla_db_live_s_results <- t.test(p_s_abla_gbdbub $db_temp, p_s_abla_gbdbub$ub_temp)

print(p_ttest_abla_db_live_s_results)
```

```{r}
#transitional accumulation - DB vs Live South
t_ttest_accum_db_live_s_results <- t.test(t_s_accu_gbdbub $db_temp, t_s_accu_gbdbub$ub_temp)

print(t_ttest_accum_db_live_s_results)

t_ttest_abla_db_live_s_results <- t.test(t_s_abla_gbdbub $db_temp, t_s_abla_gbdbub$ub_temp)

print(t_ttest_abla_db_live_s_results)
```

GB - South vs Charred/Uncharred

```{r}
p_accu_gb <- full_hourly_gb %>%
  filter(zone == "PSZ", snow_phase == "accumulation")

p_abla_gb <- full_hourly_gb %>%
  filter(zone == "PSZ", snow_phase == "ablation")

t_accu_gb <- full_hourly_gb %>%
  filter(zone == "TSZ", snow_phase == "accumulation")

t_abla_gb <- full_hourly_gb %>%
  filter(zone == "TSZ", snow_phase == "ablation")
```

```{r}
#persistent accumulation - S/C
p_ttest_accum_gb_s_c_results <- t.test(p_accu_gb$south_temp, p_accu_gb$charred_temp)

print(p_ttest_accum_gb_s_c_results)

p_ttest_abla_gb_s_c_results <- t.test(p_abla_gb$south_temp, p_abla_gb$charred_temp)

print(p_ttest_abla_gb_s_c_results)
```

```{r}
#transitional accumulation - S/C
t_ttest_accum_gb_s_c_results <- t.test(t_accu_gb$south_temp, t_accu_gb$charred_temp)

print(t_ttest_accum_gb_s_c_results)

t_ttest_abla_gb_s_c_results <- t.test(t_abla_gb$south_temp, t_abla_gb$charred_temp)

print(t_ttest_abla_gb_s_c_results)
```

GB vs DB vs Live - NO Aspect - updated 2025-01-17

```{r}
p_accu_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "PSZ", snow_phase == "accumulation")

p_abla_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "PSZ", snow_phase == "ablation")

t_accu_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "TSZ", snow_phase == "accumulation")

t_abla_gbdbub <- full_15min_gbdbub %>%
  filter(zone == "TSZ", snow_phase == "ablation")
```

```{r}
#GB vs DB
p_ttest_accum_gb_db_results <- t.test(p_accu_gbdbub$gb_temp, p_accu_gbdbub$db_temp)

print(p_ttest_accum_gb_db_results)

t_ttest_accum_gb_db_results <- t.test(t_accu_gbdbub$gb_temp, t_accu_gbdbub$db_temp)

print(t_ttest_accum_gb_db_results)
```

```{r}
#GB vs Live
p_ttest_accum_gb_ub_results <- t.test(p_accu_gbdbub$gb_temp, p_accu_gbdbub$ub_temp)

print(p_ttest_accum_gb_ub_results)

t_ttest_accum_gb_ub_results <- t.test(t_accu_gbdbub$gb_temp, t_accu_gbdbub$ub_temp)

print(t_ttest_accum_gb_ub_results)
```

```{r}
#DB vs Live
p_ttest_accum_db_ub_results <- t.test(p_accu_gbdbub$db_temp, p_accu_gbdbub$ub_temp)

print(p_ttest_accum_db_ub_results)

t_ttest_accum_db_ub_results <- t.test(t_accu_gbdbub$db_temp, t_accu_gbdbub$ub_temp)

print(t_ttest_accum_db_ub_results)
```

Accumulation

```{r}
#GB vs DB
p_ttest_abla_gb_db_results <- t.test(p_abla_gbdbub$gb_temp, p_abla_gbdbub$db_temp)

print(p_ttest_abla_gb_db_results)

t_ttest_abla_gb_db_results <- t.test(t_abla_gbdbub$gb_temp, t_abla_gbdbub$db_temp)

print(t_ttest_abla_gb_db_results)
```

```{r}
#GB vs Live
p_ttest_abla_gb_ub_results <- t.test(p_abla_gbdbub$gb_temp, p_abla_gbdbub$ub_temp)

print(p_ttest_abla_gb_ub_results)

t_ttest_abla_gb_ub_results <- t.test(t_abla_gbdbub$gb_temp, t_abla_gbdbub$ub_temp)

print(t_ttest_abla_gb_ub_results)
```

```{r}
#DB vs Live
p_ttest_abla_db_ub_results <- t.test(p_abla_gbdbub$db_temp, p_abla_gbdbub$ub_temp)

print(p_ttest_abla_db_ub_results)

t_ttest_abla_db_ub_results <- t.test(t_abla_gbdbub$db_temp, t_abla_gbdbub$ub_temp)

print(t_ttest_abla_db_ub_results)
```

GB Comparisons

GB- South vs Uncharred

```{r}
#persistent accumulation - S/UC
p_ttest_accum_gb_s_uc_results <- t.test(p_accu_gb$south_temp, p_accu_gb$uncharred_temp)

print(p_ttest_accum_gb_s_uc_results)

p_ttest_abla_gb_s_uc_results <- t.test(p_abla_gb$south_temp, p_abla_gb$uncharred_temp)

print(p_ttest_abla_gb_s_uc_results)
```

```{r}
#transitional accumulation - S/UC
t_ttest_accum_gb_s_uc_results <- t.test(t_accu_gb$south_temp, t_accu_gb$uncharred_temp)

print(t_ttest_accum_gb_s_uc_results)

t_ttest_abla_gb_s_uc_results <- t.test(t_abla_gb$south_temp, t_abla_gb$uncharred_temp)

print(t_ttest_abla_gb_s_uc_results)
```

GB- North vs Charred

```{r}
#persistent accumulation - N/C
p_ttest_accum_gb_n_c_results <- t.test(p_accu_gb$north_temp, p_accu_gb$charred_temp)

print(p_ttest_accum_gb_n_c_results)

p_ttest_abla_gb_n_c_results <- t.test(p_abla_gb$north_temp, p_abla_gb$charred_temp)

print(p_ttest_abla_gb_n_c_results)
```

```{r}
#transitional accumulation - N/C
t_ttest_accum_gb_n_c_results <- t.test(t_accu_gb$north_temp, t_accu_gb$charred_temp)

print(t_ttest_accum_gb_n_c_results)

t_ttest_abla_gb_n_c_results <- t.test(t_abla_gb$north_temp, t_abla_gb$charred_temp)

print(t_ttest_abla_gb_n_c_results)
```

GB- North vs Uncharred

```{r}
#persistent accumulation - N/UC
p_ttest_accum_gb_n_uc_results <- t.test(p_accu_gb$north_temp, p_accu_gb$uncharred_temp)

print(p_ttest_accum_gb_n_uc_results)

p_ttest_abla_gb_n_uc_results <- t.test(p_abla_gb$north_temp, p_abla_gb$uncharred_temp)

print(p_ttest_abla_gb_n_uc_results)
```

```{r}
#transitional accumulation - N/UC
t_ttest_accum_gb_n_uc_results <- t.test(t_accu_gb$north_temp, t_accu_gb$uncharred_temp)

print(t_ttest_accum_gb_n_uc_results)

t_ttest_abla_gb_n_uc_results <- t.test(t_abla_gb$north_temp, t_abla_gb$uncharred_temp)

print(t_ttest_abla_gb_n_uc_results)
```

GB - Charred vs Uncharred

```{r}
#persistent accumulation - C/UC
p_ttest_accum_gb_c_uc_results <- t.test(p_accu_gb$charred_temp, p_accu_gb$uncharred_temp)

print(p_ttest_accum_gb_c_uc_results)

p_ttest_abla_gb_c_uc_results <- t.test(p_abla_gb$charred_temp, p_abla_gb$uncharred_temp)

print(p_ttest_abla_gb_c_uc_results)
```

```{r}
#transitional accumulation - C/UC
t_ttest_accum_gb_c_uc_results <- t.test(t_accu_gb$charred_temp, t_accu_gb$uncharred_temp)

print(t_ttest_accum_gb_c_uc_results)

t_ttest_abla_gb_c_uc_results <- t.test(t_abla_gb$charred_temp, t_abla_gb$uncharred_temp)

print(t_ttest_abla_gb_c_uc_results)
```

# Calculating Min and Max values & Day/Night comparison values for tables in thesis

```{r}
mean_dtnt_db_temps <- full_15min_gbdbub %>%
  select(datetime, day, month, phase, zone, aspect, db_temp) %>%
  group_by(datetime, day, month, phase, zone, aspect) %>%
  summarise(db_temp = mean(db_temp, na.rm = TRUE), .groups = "drop") %>%
  pivot_wider(names_from = aspect, values_from = db_temp) %>%
  mutate(mean_temp = (north + south) / 2) %>%
  group_by(month, phase, zone) %>%
  summarize(mean_temp = mean(mean_temp))

#getting dtnt single average from original dataset for db trees
mean_dtnt_single_db_temp <- full_15min_gbdbub %>%
  select(datetime, day, month, phase, zone, aspect, db_temp) %>%
  group_by(datetime, day, month, phase, zone, aspect) %>%
  summarise(db_temp = mean(db_temp, na.rm = TRUE), .groups = "drop") %>%
  pivot_wider(names_from = aspect, values_from = db_temp) %>%
  mutate(mean_temp = (north + south) / 2) %>%
  group_by(phase, zone) %>%
  summarize(mean_db_temp = mean(mean_temp))
```

```{r}
mean_dtnt_gb_temps <- full_15min_gbdbub %>%
  select(datetime, day, month, phase, zone, aspect, gb_temp) %>%
  group_by(datetime, day, month, phase, zone, aspect) %>%
  summarise(gb_temp = mean(gb_temp, na.rm = TRUE), .groups = "drop") %>%
  pivot_wider(names_from = aspect, values_from = gb_temp) %>%
  mutate(mean_temp = (north + south) / 2) %>%
  group_by(month, phase, zone) %>%
  summarize(mean_temp = mean(mean_temp))

#getting dtnt single average from original dataset for gb trees
mean_dtnt_single_gb_temp <- full_15min_gbdbub %>%
  select(datetime, day, month, phase, zone, aspect, gb_temp) %>%
  group_by(datetime, day, month, phase, zone, aspect) %>%
  summarise(gb_temp = mean(gb_temp, na.rm = TRUE), .groups = "drop") %>%
  pivot_wider(names_from = aspect, values_from = gb_temp) %>%
  mutate(mean_temp = (north + south) / 2) %>%
  group_by(phase, zone) %>%
  summarize(mean_gb_temp = mean(mean_temp))
```

```{r}
mean_dtnt_ub_temps <- full_15min_gbdbub %>%
  select(datetime, day, month, phase, zone, aspect, ub_temp) %>%
  group_by(datetime, day, month, phase, zone, aspect) %>%
  summarise(ub_temp = mean(ub_temp, na.rm = TRUE), .groups = "drop") %>%
  pivot_wider(names_from = aspect, values_from = ub_temp) %>%
  mutate(mean_temp = (north + south) / 2) %>%
  group_by(month, phase, zone) %>%
  summarize(mean_temp = mean(mean_temp))

#getting dtnt single average from original dataset for ub trees
mean_dtnt_single_ub_temp <- full_15min_gbdbub %>%
  select(datetime, day, month, phase, zone, aspect, ub_temp) %>%
  group_by(datetime, day, month, phase, zone, aspect) %>%
  summarise(ub_temp = mean(ub_temp, na.rm = TRUE), .groups = "drop") %>%
  pivot_wider(names_from = aspect, values_from = ub_temp) %>%
  mutate(mean_temp = (north + south) / 2) %>%
  group_by(phase, zone) %>%
  summarize(mean_ub_temp = mean(mean_temp))
```

```{r}
#full single value comparison of dtnt tree temps by burn status
full_singlevalue_treetemp_comp <- mean_dtnt_single_gb_temp %>%
  left_join(mean_dtnt_single_db_temp) %>%
  left_join(mean_dtnt_single_ub_temp)
```

Getting minimum and maximum total values for phase and zone

```{r}
max_gb_temp_per_phase <- full_15min_gbdbub %>%
  group_by(zone, phase, aspect) %>%
  summarise(max_gb_temp = max(gb_temp, na.rm = TRUE), .groups = "drop")

max_db_temp_per_phase <- full_15min_gbdbub %>%
  group_by(zone, phase, aspect) %>%
  summarise(max_db_temp = max(db_temp, na.rm = TRUE), .groups = "drop")

max_ub_temp_per_phase <- full_15min_gbdbub %>%
  group_by(zone, phase, aspect) %>%
  summarise(max_ub_temp = max(ub_temp, na.rm = TRUE), .groups = "drop")
```

Getting Min and Max values by accumulation and ablation season

```{r}
mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )
  ) %>%
```

```{r}
#accumulation mean vs ablation mean for char patterns
accu_abla_charpattern <- full_hourly_gb %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )
  ) %>%
  filter(phase == "day") %>%
  group_by(snow_phase, zone) %>%
  summarize(north_temp = mean(north_temp, na.rm = TRUE),
            south_temp = mean(south_temp, na.rm = TRUE),
            charred_temp = mean(charred_temp, na.rm = TRUE),
            uncharred_temp = mean(uncharred_temp, na.rm = TRUE),
            .groups = "drop")
```

```{r}
#accumulation vs ablation mean temps for north and south
accu_abla_ns <- full_15min_ns %>%
  mutate(
    zone = case_when(
      zone == "transitional" ~ "TSZ",
      zone == "persistent" ~ "PSZ",
      TRUE ~ zone # Keep other values unchanged
    )
  ) %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )
  ) %>%
  filter(phase == "day") %>%
  group_by(zone) %>%
  summarize(north_temp = mean(north_temp, na.rm = TRUE), south_temp = mean(south_temp, na.rm = TRUE), ns_avg_temp = mean(ns_avg_temp, na.rm = TRUE))

accu_abla_ns_combined <- full_15min_ns %>%
  mutate(
    zone = case_when(
      zone == "transitional" ~ "TSZ",
      zone == "persistent" ~ "PSZ",
      TRUE ~ zone # Keep other values unchanged
    )
  ) %>%
  mutate( # Add `snow_phase` before summarizing
    snow_phase = case_when(
      (zone == "PSZ" & day >= as.Date("2024-05-06")) ~ "ablation",
      (zone == "TSZ" & day >= as.Date("2024-04-06")) ~ "ablation",
      TRUE ~ "accumulation"
    )
  ) %>%
  filter(phase == "day") %>%
  #not filtering by burn status
  group_by(snow_phase, zone) %>%
  summarize(north_temp = mean(north_temp, na.rm = TRUE), south_temp = mean(south_temp, na.rm = TRUE), ns_avg_temp = mean(ns_avg_temp, na.rm = TRUE))
```

## Ablation vs Accumulation T-Test
