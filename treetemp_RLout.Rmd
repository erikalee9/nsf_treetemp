---
title: "treetemp_RLout"
output: html_document
date: "2024-10-21"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#initial set up
library(tidyverse)
library(lterdatasampler)
library(dplyr)
library(ggplot2)
library(readr)
library(readxl)
library(lubridate)
library(plotly)
library(openxlsx)
library(plotly)
library(rstatix)
library(htmlwidgets)
library(RColorBrewer)
library(patchwork)
#packages for exporting csvs as tables
library(knitr)
library(kableExtra)
library(pagedown)
library(ggpubr)
library(ggpattern)

setwd("/Volumes/wcnr-network/Research/Kampf/Private/field_data")
```

# Loading Full Datasets

```{r}
#new full dataframes to load - including burned and unburned/ all burn_status types together
full_15min_ns <- read_csv("nsf/treetemp_data/full_15min_ns.csv") %>%
  mutate(datetime = as.POSIXct(datetime, format=("%Y-%m-%d %H:%M:%S")),
                               datetime = force_tz(datetime, tz = 'MST')) %>%
  select(-1)

full_hourly_ns <- read_csv("nsf/treetemp_data/full_hourly_ns.csv") %>%
   mutate(datetime_hour = as.POSIXct(datetime_hour, format=("%Y-%m-%d %H:%M:%S")),
                               datetime_hour = force_tz(datetime_hour, tz = 'MST'))  %>%
  select(-1)

full_15min_gbdbub <- read_csv("nsf/treetemp_data/full_15min_gbdbub.csv") %>%
  mutate(datetime = as.POSIXct(datetime, format=("%Y-%m-%d %H:%M:%S")),
                               datetime = force_tz(datetime, tz = 'MST'))  %>%
  select(-1)

full_hourly_gbdbub <- read_csv("nsf/treetemp_data/full_hourly_gbdbub.csv") %>%
  mutate(datetime_hour = as.POSIXct(datetime_hour, format=("%Y-%m-%d %H:%M:%S")),
                               datetime_hour = force_tz(datetime_hour, tz = 'MST'))  %>%
  select(-1)

full_hourly_gb <- read_csv("nsf/treetemp_data/full_hourly_gb.csv") %>%
  mutate(datetime_hour = as.POSIXct(datetime_hour, format=("%Y-%m-%d %H:%M:%S")),
                               datetime_hour = force_tz(datetime_hour, tz = 'MST'))  %>%
  select(-1)
```

# LWout Calculations

## Setting Constants

```{r}
#pulling in dataframe that has tree circumference data by site
treecirc_data <- read_csv("nsf/treetemp_data/105E_treecirc_data.csv")
```

Constants

```{r}
# Constants
stefan_boltzmann_constant <- 5.67e-8
emissivity <- 0.97
#snowdepth and circumference are in meters
snowdepth <- 1
# circumference is taken from diameter at breast height 
p_db_circ <- 0.5576
p_gb_circ <- 0.4006
p_live_circ <- 0.5027
t_db_circ <- 0.5655
t_gb_circ <- 0.5812
t_live_circ <- 0.5341

#picking an average unit depth for snow depth of 1 meter
#constant for m2 - can adjust this if I want to change the snowdepth!
p_gb_m2 = snowdepth*p_gb_circ
p_db_m2 = snowdepth*p_db_circ
p_live_m2 = snowdepth*p_live_circ
t_gb_m2 = snowdepth*t_gb_circ
t_db_m2 = snowdepth*t_db_circ
t_live_m2 = snowdepth*t_live_circ
```

## LWout Calcs

Full_15min_NS

```{r}
#full_15min_ns
##converting temps in OG dataset to K from C
full_15min_ns_K <- full_15min_ns %>%
  mutate(north_temp_k = (north_temp + 273.15), south_temp_k = (south_temp + 273.15), ns_avg_temp_k = (ns_avg_temp + 273.15))
```

```{r}
#LWout calcs
full_15min_ns_LWout <- full_15min_ns_K %>%
  mutate(
    # Calculate longwave radiation in Wperm^2
    n_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (north_temp_k^4), s_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (south_temp_k^4)
  ) %>%
  #setting a case_when to vary the circumference/snow depth measurement by tree burn status and zone
  mutate(m2 = case_when(
      burn_status == "green burn" & zone == "persistent" ~ 0.4006,   # Example value for burned in north zone
      burn_status == "dead burn" & zone == "persistent" ~ 0.5576,   # Example value for burned in south zone
      burn_status == "live" & zone == "persistent" ~ 0.5027,
      burn_status == "green burn" & zone == "transitional" ~ 0.5812,   # Example value for burned in north zone
      burn_status == "dead burn" & zone == "transitional" ~ 0.5655,   # Example value for burned in south zone
      burn_status == "live" & zone == "transitional" ~ 0.5341,
      TRUE ~ 0.4006  # Default value if neither of the conditions match
    ),
#calcuating Watz (power) - dividing m2 by 2 for the north/south aspect differences as we assume that the area is only 1/2 the tree by aspect
    n_W =  n_LWout_wperm2 * (m2/2),
    s_W =  s_LWout_wperm2 * (m2/2),
#converting from Wperm2 to MJ/day
    n_LWout_MJperd = n_W * 86400 / 1e6, 
s_LWout_MJperd = s_W * 86400 / 1e6) 
```

Full_Hourly_NS

```{r}
#full_15min_ns
full_hourly_ns_K <- full_hourly_ns %>%
  mutate(north_temp_k = (north_temp + 273.15), south_temp_k = (south_temp + 273.15), ns_avg_temp_k = (ns_avg_temp + 273.15))
```

```{r}
#LWout calcs
full_hourly_ns_LWout <- full_hourly_ns_K %>%
  mutate(
    # Calculate longwave radiation in Wperm^2
    n_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (north_temp_k^4), s_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (south_temp_k^4)
  ) %>%
  #setting a case_when to vary the circumference/snow depth measurement by tree burn status and zone
  mutate(m2 = case_when(
      burn_status == "green burn" & zone == "persistent" ~ 0.4006,   # Example value for burned in north zone
      burn_status == "dead burn" & zone == "persistent" ~ 0.5576,   # Example value for burned in south zone
      burn_status == "live" & zone == "persistent" ~ 0.5027,
      burn_status == "green burn" & zone == "transitional" ~ 0.5812,   # Example value for burned in north zone
      burn_status == "dead burn" & zone == "transitional" ~ 0.5655,   # Example value for burned in south zone
      burn_status == "live" & zone == "persistent" ~ 0.5341,
      TRUE ~ 0.4006  # Default value if neither of the conditions match
    ),
#calcuating Watz (power) - dividing m2 by 2 for the north/south aspect differences as we assume that the area is only 1/2 the tree by aspect
    n_W =  n_LWout_wperm2 * (m2/2),
    s_W =  s_LWout_wperm2 * (m2/2),
#converting from Wperm2 to MJ/day
    n_LWout_MJperd = n_W * 86400 / 1e6, 
s_LWout_MJperd = s_W * 86400 / 1e6)
```

Full 15min GBDBUB

```{r}
full_15min_gbdbub_K <- full_15min_gbdbub %>%
  mutate(gb_temp_k = (gb_temp + 273.15), db_temp_k = (db_temp + 273.15), ub_temp_k = (ub_temp + 273.15))
```

```{r}
#LWout calcs
full_15min_gbdbub_LWout <- full_15min_gbdbub_K %>%
  #calculating LWout in Wperm^2 by burn_status
  mutate(gb_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (gb_temp_k^4), db_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (db_temp_k^4), ub_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (ub_temp_k^4)) %>%
  # Define m2 based on zone
    mutate(gb_m2 = case_when(zone == "persistent" ~ 0.4006,
zone == "transitional" ~ 0.5812, TRUE ~ 0.4006), db_m2 = case_when(zone == "persistent" ~ 0.5576, zone == "transitional" ~ 0.5655, TRUE ~ 0.5576), ub_m2 = case_when(zone == "persistent" ~ 0.5027, zone == "transitional" ~ 0.5341, TRUE ~ 0.5576)) %>%
  #calcuating Watz (power)
  mutate(
    gb_W = gb_LWout_wperm2 * (gb_m2/2),
    db_W =  db_LWout_wperm2 * (db_m2/2),
    ub_W =  ub_LWout_wperm2 * (ub_m2/2),
#converting from Wperm2 to MJ/day
    gb_LWout_MJperd = gb_W * 86400 / 1e6, 
db_LWout_MJperd = db_W * 86400 / 1e6, ub_LWout_MJperd = ub_W * 86400 / 1e6)
```

Full Hourly GB

```{r}
full_hourly_gb_K <- full_hourly_gb %>%
  mutate(north_temp_k = (north_temp + 273.15), south_temp_k = (south_temp + 273.15), charred_temp_k = (charred_temp + 273.15), uncharred_temp_k = (uncharred_temp + 273.15))
```

The following dataframe can be used for plotting comparison of GB-only aspect/char pattern comparisons

\*\* Don't need to use this - we'll address gb char pattern in another, earlier assessment.

```{r}
full_hourly_gb_LWout <- full_hourly_gb_K %>%
  mutate(
    # Calculate longwave radiation in Wperm^2
    n_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (north_temp_k^4), s_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (south_temp_k^4), c_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (charred_temp_k^4), uc_LWout_wperm2 = emissivity * stefan_boltzmann_constant * (uncharred_temp_k^4)) %>%
  # Define m2 based on zone
    mutate(gb_m2 = case_when(zone == "persistent" ~ 0.4006,
zone == "transitional" ~ 0.5812, TRUE ~ 0.4006), 
#calcuating Watz (power)- dividing m2 by 2 for the north/south aspect differences as we assume that the area is only 1/2 the tree by aspect
    n_W =  n_LWout_wperm2 * (gb_m2/2),
    s_W =  s_LWout_wperm2 * (gb_m2/2),
c_W =  c_LWout_wperm2 * (gb_m2/2),
uc_W =  uc_LWout_wperm2 * (gb_m2/2),
#converting from Wperm2 to MJ/day
    n_LWout_MJperd = n_W * 86400 / 1e6, 
s_LWout_MJperd = s_W * 86400 / 1e6, c_LWout_MJperd = c_W * 86400 / 1e6, uc_LWout_MJperd = uc_W * 86400 / 1e6)
```

# Daily Mean Datasets

-   taking the 15-minute datasets and making daily mean datasets with day/night phase means

-   Then doing an accumulation dataset for each day

```{r}
## use this dataset if I want to plot daily mean values!
full_daily_ns_LWout <- full_15min_ns_LWout %>%
  group_by(day, month, phase, zone, burn_status) %>%
  summarize(north_temp = mean(north_temp), south_temp = mean(south_temp), ns_avg_temp = mean(ns_avg_temp), n_LWout_wperm2 = mean(n_LWout_wperm2), s_LWout_wperm2 = mean(s_LWout_wperm2), n_LWout_MJperd = mean(n_LWout_MJperd), s_LWout_MJperd = mean(s_LWout_MJperd))
```

```{r}
#creating an accumulation dataframe
## use this dataset if I want to plot cumulative values!
accu_full_daily_ns_LWout <- full_daily_ns_LWout %>%
  group_by(zone, burn_status) %>%  # Group by zone and burn_status
  mutate(accu_daily_n_LWout_MJperd = cumsum(n_LWout_MJperd), accu_daily_s_LWout_MJperd = cumsum(s_LWout_MJperd)) %>%
  select(day, month, phase, zone, burn_status, accu_daily_n_LWout_MJperd, accu_daily_s_LWout_MJperd)
```

```{r}
#creating zone specific n_s dataframes from accumulation dataframe - DAY ONLY ASSESSMENT
accu_pers_dt_ns_LWout <- accu_full_daily_ns_LWout %>%
  filter(zone == "persistent", phase == "day")

accu_trans_dt_ns_LWout <- accu_full_daily_ns_LWout %>%
  filter(zone == "transitional", phase == "day")
```

```{r}
#pers plot
accum_pers_dt_ns_plot <- ggplot(data = accu_pers_dt_ns_LWout) +
  geom_line(aes(x = day, y = accu_daily_n_LWout_MJperd), color = "black") +
  geom_line(aes(x = day, y = accu_daily_s_LWout_MJperd), color = "red") +
  facet_wrap(~zone + burn_status + phase)

accum_pers_dt_ns_plot
```

```{r}
#trans plot
accum_trans_dt_ns_plot <- ggplot(data = accu_trans_dt_ns_LWout) +
  geom_line(aes(x = day, y = accu_daily_n_LWout_MJperd), color = "black") +
  geom_line(aes(x = day, y = accu_daily_s_LWout_MJperd), color = "red") +
  facet_wrap(~zone + burn_status + phase)

accum_trans_dt_ns_plot
```

```{r}
#full plot for daytime values that is only face-wrapped by burn_status and zone
## USE THIS DATAFRAME
accu_dt_ns_LWout <- accu_full_daily_ns_LWout %>%
  filter(phase == "day") %>%
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep the original value if it's neither "persistent" nor "transitional"
  ))
```

```{r}
##use this plot!
accu_dt_ns_plot <- ggplot(data = accu_dt_ns_LWout) +
  geom_line(aes(x = day, y = accu_daily_n_LWout_MJperd, color = "north"), alpha = 0.9) +  # First line labeled "No Snow"
  geom_line(aes(x = day, y = accu_daily_s_LWout_MJperd, color = "south")) +     # Second line labeled "Snow"
  facet_wrap(~zone + burn_status) +
  theme_bw() +
  labs(
    #title = "Daily Accumulation Data by Burn Status & Zone",
    x = "Date",
    y = "Daily Accumulated LWout (MJ/day)",
    color = "Aspect"  # Legend title
  ) +
  scale_color_manual(values = c("north" = "gray25", "south" = "#D95F02"))

accu_dt_ns_plot
```

GBDBUB Dataframe

```{r}
## use this dataset if I want to plot daily mean values!
full_daily_gbdbub_LWout <- full_15min_gbdbub_LWout %>%
  group_by(day, month, phase, zone, aspect) %>%
  summarize(gb_temp = mean(gb_temp), db_temp = mean(db_temp), ub_temp = mean(ub_temp), gb_LWout_wperm2 = mean(gb_LWout_wperm2), db_LWout_wperm2 = mean(db_LWout_wperm2), ub_LWout_wperm2 = mean(ub_LWout_wperm2), gb_LWout_MJperd = mean(gb_LWout_MJperd), db_LWout_MJperd = mean(db_LWout_MJperd), ub_LWout_MJperd = mean(ub_LWout_MJperd))
```

```{r}
#accumulation dataframe
accu_full_daily_gbdbub_LWout <- full_daily_gbdbub_LWout %>%
  group_by(zone, aspect) %>%  # Group by zone and aspect
  mutate(accu_daily_gb_LWout_MJperd = cumsum(gb_LWout_MJperd), accu_daily_db_LWout_MJperd = cumsum(db_LWout_MJperd), accu_daily_ub_LWout_MJperd = cumsum(ub_LWout_MJperd)) %>%
  select(day, month, phase, zone, aspect, accu_daily_gb_LWout_MJperd, accu_daily_db_LWout_MJperd, accu_daily_ub_LWout_MJperd)

#use this dataframe for final plotting
accu_dt_gbdbub_LWout <- accu_full_daily_gbdbub_LWout %>%
  filter(phase == "day") %>%
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ",
    zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # Keep the original value if it's neither "persistent" nor "transitional"
  ))
```

```{r}
#
cum_dt_gbdbub_plot <- ggplot(data = accu_dt_gbdbub_LWout) +
  geom_line(aes(x = day, y = accu_daily_gb_LWout_MJperd, color = "green burn", linetype = aspect), linewidth = 0.6) +  
  geom_line(aes(x = day, y = accu_daily_db_LWout_MJperd, color = "dead burn", linetype = aspect), linewidth = 0.6) +
  geom_line(aes(x = day, y = accu_daily_ub_LWout_MJperd, color = "live", linetype = aspect), linewidth = 0.6) +
  facet_wrap(~zone + aspect, dir = "v") +
  theme_bw() +
  labs(
    x = "Date",
    y = "Daily Cumulative LWout (MJ/day)",
    color = "Burn Status", 
    linetype = "Aspect"
  ) +
  scale_color_manual(values = c("green burn" = "#1B7837", "dead burn" = "#D95F02", "live" = adjustcolor("#2166AC", alpha = 0.7))) +
  scale_linetype_manual(values = c("north" = "dashed", "south" = "solid"))

cum_dt_gbdbub_plot
```

# Boxplots of Char Pattern Comparisons

## GB Trees

```{r}
#making a daytime dataframe 
full_hourly_gb_dt <- full_hourly_gb %>%
  filter(phase == "day") %>%
  rename(north = north_temp, south = south_temp, charred = charred_temp, uncharred = uncharred_temp) %>%
  pivot_longer(cols = c(north, south, charred, uncharred),
               names_to = "temp_type", values_to = "temperature") %>%
  select(datetime_hour, day, month, phase, zone, burn_status, temp_type, temperature)

#parsing into zone dataframes
pers_full_hourly_gb_dt <- full_hourly_gb_dt %>%
  filter(zone == "persistent") %>%
  mutate(zone = "PSZ")

trans_full_hourly_gb_dt <- full_hourly_gb_dt %>%
  filter(zone == "transitional") %>%
  mutate(zone = "TSZ")
```

```{r}
#PSZ
pers_dt_gb_aspect_comparison <- ggplot(pers_full_hourly_gb_dt) + 
  geom_boxplot(aes(x = temp_type, y = temperature, fill = temp_type)) + 
  facet_wrap(~ zone + month + phase, scales = "free") + 
  scale_fill_manual(
    values = c("north" = "green", "south" = "red", "charred" = "black", "uncharred" = "grey"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect of Temp Sensor", y = "Temperature (°C)") +
  theme_bw()

pers_dt_gb_aspect_comparison
```

```{r}
#TSZ
trans_dt_gb_aspect_comparison <- ggplot(trans_full_hourly_gb_dt) + 
  geom_boxplot(aes(x = temp_type, y = temperature, fill = temp_type)) + 
  facet_wrap(~ zone + month + phase, scales = "free") + 
  scale_fill_manual(
    values = c("north" = "green", "south" = "red", "charred" = "black", "uncharred" = "grey"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect of Temp Sensor", y = "Temperature (°C)") +
  theme_bw()

trans_dt_gb_aspect_comparison
```

\*\* could just do box plots of statistically significant comparisons and put p-values on them?

## GB Trees (N/S only)

```{r}
#making a daytime dataframe 
full_15min_gb_dt <- full_15min_gbdbub %>%
  filter(phase == "day") %>%
  select(datetime, day, month, phase, zone, aspect, gb_temp) %>%
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ", zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # This line ensures other zones are preserved
  )) %>%
  mutate(burn_status = "green burn")

#parsing into zone dataframes
pers_full_15min_gb_dt <- full_15min_gb_dt %>%
  filter(zone == "PSZ")

#have to filter individually to add p-value to boxes
feb_pers_gb <- pers_full_15min_gb_dt %>%
  filter(month == "2")

march_pers_gb <- pers_full_15min_gb_dt %>%
  filter(month == "3")

april_pers_gb <- pers_full_15min_gb_dt %>%
  filter(month == "4")

may_pers_gb <- pers_full_15min_gb_dt %>%
  filter(month == "5")
  

trans_full_15min_gb_dt <- full_15min_gb_dt %>%
  filter(zone == "TSZ")

#have to filter individually to add p-value to boxes
feb_trans_gb <- trans_full_15min_gb_dt %>%
  filter(month == "2")

march_trans_gb <- trans_full_15min_gb_dt %>%
  filter(month == "3")

april_trans_gb <- trans_full_15min_gb_dt %>%
  filter(month == "4")

may_trans_gb <- trans_full_15min_gb_dt %>%
  filter(month == "5")
```

\*\* as of 2024-10-23 - don't have monthly zone p-values for green burned yet. Need to get these to finalize plots!

```{r}
#individual month plots
feb_pers_gb_plot <- ggplot(feb_pers_gb) + 
  geom_boxplot(aes(x = aspect, y = gb_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
feb_pers_gb_plot <- feb_pers_gb_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

feb_pers_gb_plot
```

```{r}
#individual month plots
march_pers_gb_plot <- ggplot(march_pers_gb) + 
  geom_boxplot(aes(x = aspect, y = gb_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
march_pers_gb_plot <- march_pers_gb_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

march_pers_gb_plot
```

```{r}
april_pers_gb_plot <- ggplot(april_pers_gb) + 
  geom_boxplot(aes(x = aspect, y = gb_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
april_pers_gb_plot <- april_pers_gb_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

april_pers_gb_plot
```

```{r}
may_pers_gb_plot <- ggplot(may_pers_gb) + 
  geom_boxplot(aes(x = aspect, y = gb_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
may_pers_gb_plot <- may_pers_gb_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

may_pers_gb_plot
```

```{r}
#combining individual month PSZ plots
full_pers_gb_plots <- ggarrange(feb_pers_gb_plot, march_pers_gb_plot, april_pers_gb_plot, may_pers_gb_plot, nrow = 1, ncol = 4)

full_pers_gb_plots
```

```{r}
#individual month plots
feb_trans_gb_plot <- ggplot(feb_trans_gb) + 
  geom_boxplot(aes(x = aspect, y = gb_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
feb_trans_gb_plot <- feb_trans_gb_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

feb_trans_gb_plot
```

```{r}
march_trans_gb_plot <- ggplot(march_trans_gb) + 
  geom_boxplot(aes(x = aspect, y = gb_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
march_trans_gb_plot <- feb_trans_gb_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

march_trans_gb_plot
```

```{r}
april_trans_gb_plot <- ggplot(april_trans_gb) + 
  geom_boxplot(aes(x = aspect, y = gb_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
april_trans_gb_plot <- april_trans_gb_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

april_trans_gb_plot
```

```{r}
may_trans_gb_plot <- ggplot(may_trans_gb) + 
  geom_boxplot(aes(x = aspect, y = gb_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
may_trans_gb_plot <- may_trans_gb_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

may_trans_gb_plot
```

```{r}
#combining individual month PSZ plots
full_trans_gb_plots <- ggarrange(feb_trans_gb_plot, march_trans_gb_plot, april_trans_gb_plot, may_trans_gb_plot, nrow = 1, ncol = 4)

full_trans_gb_plots
```

```{r}
full_gb_plots <- ggarrange(full_pers_gb_plots, full_trans_gb_plots, nrow = 2, ncol = 1)

#adjusting the labels so they are shared
full_gb_plots <- annotate_figure(full_gb_plots,
                                  left = textGrob("Temperature (°C)", gp = gpar(fontsize = 10), rot = 90),
                                  bottom = textGrob("Aspect", gp = gpar(fontsize = 10)))


full_gb_plots
```

## DB Trees

```{r}
#making a daytime dataframe 
full_15min_db_dt <- full_15min_gbdbub %>%
  filter(phase == "day") %>%
  select(datetime, day, month, phase, zone, aspect, db_temp) %>%
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ", zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # This line ensures other zones are preserved
  )) %>%
  mutate(burn_status = "dead burn")

#parsing into zone dataframes
pers_full_15min_db_dt <- full_15min_db_dt %>%
  filter(zone == "PSZ")

#have to filter individually to add p-value to boxes
feb_pers_db <- pers_full_15min_db_dt %>%
  filter(month == "2")

march_pers_db <- pers_full_15min_db_dt %>%
  filter(month == "3")

april_pers_db <- pers_full_15min_db_dt %>%
  filter(month == "4")

may_pers_db <- pers_full_15min_db_dt %>%
  filter(month == "5")
  

trans_full_15min_db_dt <- full_15min_db_dt %>%
  filter(zone == "TSZ")

#have to filter individually to add p-value to boxes
feb_trans_db <- trans_full_15min_db_dt %>%
  filter(month == "2")

march_trans_db <- trans_full_15min_db_dt %>%
  filter(month == "3")

april_trans_db <- trans_full_15min_db_dt %>%
  filter(month == "4")

may_trans_db <- trans_full_15min_db_dt %>%
  filter(month == "5")
```

\*\* keep on working on the boxplot below! The data is stacking isntead of going next to each other. 2024-10-23

```{r}

full_15min_db_dt_plot <- ggplot(full_15min_db_dt) +
  # Solid boxplots for 'persistent' zone
  geom_boxplot(data = full_15min_db_dt[full_15min_db_dt$zone == "PSZ", ],
               aes(x = aspect, y = db_temp, fill = aspect),
               position = position_dodge(width = 0.8),  # Side-by-side
               width = 0.4) +  # Adjust width for better spacing
  # Patterned boxplots for 'transitional' zone
  geom_boxplot_pattern(data = full_15min_db_dt[full_15min_db_dt$zone == "TSZ", ],
                       aes(x = aspect, y = db_temp, fill = aspect, pattern = zone),
                       position = position_dodge(width = 0.8),  # Match the position
                       pattern = "stripe",
                       pattern_density = 0.1,
                       pattern_fill = NA,
                       width = 0.4) +  # Adjust width for better spacing
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  facet_wrap(~ burn_status + month) + 
  theme_bw() +
  theme(legend.position = "bottom")

# Print the final plot
print(full_15min_db_dt_plot)
```

```{r}
#PSZ
pers_dt_db_aspect_comparison <- ggplot(pers_full_15min_db_dt) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect)) + 
  facet_wrap(~ zone + burn_status + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  theme_bw()

pers_dt_db_aspect_comparison <- pers_dt_db_aspect_comparison + annotate("text", x = 5, y = 30, label = "p = 0.01586", size = 2, color = "black")

pers_dt_db_aspect_comparison
```

```{r}
#individual month plots
feb_pers_db_plot <- ggplot(feb_pers_db) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
feb_pers_db_plot <- feb_pers_db_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.01586", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

feb_pers_db_plot
```

```{r}
#individual month plots
march_pers_db_plot <- ggplot(march_pers_db) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
march_pers_db_plot <- march_pers_db_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.00683", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

march_pers_db_plot
```

```{r}
#individual month plots
april_pers_db_plot <- ggplot(april_pers_db) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw() + 
  theme(legend.position = "none")

#adding p-value
april_pers_db_plot <- april_pers_db_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.1671", size = 3, color = "black", fontface = "bold") + 
  labs(x = NULL, y = NULL)

april_pers_db_plot
```

```{r}
#individual month plots
may_pers_db_plot <- ggplot(may_pers_db) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw() +
  theme(legend.position = "none")

#adding p-value
may_pers_db_plot <- may_pers_db_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.5876", size = 3, color = "black", fontface = "bold") + 
  labs(x = NULL, y = NULL)

may_pers_db_plot
```

```{r}
#combining individual month PSZ plots
full_pers_db_plots <- ggarrange(feb_pers_db_plot, march_pers_db_plot, april_pers_db_plot, may_pers_db_plot, nrow = 1, ncol = 4)

full_pers_db_plots
```

```{r}
#TSZ
trans_dt_db_aspect_comparison <- ggplot(trans_full_15min_db_dt) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  theme_bw()

trans_dt_db_aspect_comparison
```

```{r}
#individual month plots
feb_trans_db_plot <- ggplot(feb_trans_db) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
feb_trans_db_plot <- feb_trans_db_plot + 
  annotate("text", x = 1, y = 35, label = " p = 0.000004", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

feb_trans_db_plot
```

```{r}
## striped version
feb_trans_db_plot_striped <- ggplot(feb_trans_db) + 
  geom_boxplot_pattern(aes(x = aspect, y = db_temp, fill = aspect),
                       pattern = "stripe",  # Use "stripe" pattern
                       pattern_density = 0.1,  # Adjust density of stripes
                       pattern_fill = "white",  # Fill color for stripes
                       pattern_angle = 45) +  # Angle of the stripes
  facet_wrap(~ zone + burn_status + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  theme_bw()

feb_trans_db_plot_striped
```

```{r}
march_trans_db_plot <- ggplot(march_trans_db) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
march_trans_db_plot <- march_trans_db_plot + 
  annotate("text", x = 1, y = 35, label = " p = 0.000001", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

march_trans_db_plot
```

```{r}
march_trans_db_plot_striped <- ggplot(march_trans_db) + 
  geom_boxplot_pattern(aes(x = aspect, y = db_temp, fill = aspect),
                       pattern = "stripe",  # Use "stripe" pattern
                       pattern_density = 0.1,  # Adjust density of stripes
                       pattern_fill = "white",  # Fill color for stripes
                       pattern_angle = 45) +  # Angle of the stripes
  facet_wrap(~ zone + burn_status + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  theme_bw()

march_trans_db_plot_striped
```

```{r}
april_trans_db_plot <- ggplot(april_trans_db) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
april_trans_db_plot <- april_trans_db_plot + 
  annotate("text", x = 1, y = 35, label = " p = 0.000323", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

april_trans_db_plot
```

```{r}
#striped version
april_trans_db_plot_striped <- ggplot(april_trans_db) + 
  geom_boxplot_pattern(aes(x = aspect, y = db_temp, fill = aspect),
                       pattern = "stripe",  # Use "stripe" pattern
                       pattern_density = 0.1,  # Adjust density of stripes
                       pattern_fill = "white",  # Fill color for stripes
                       pattern_angle = 45) +  # Angle of the stripes
  facet_wrap(~ zone + burn_status + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  theme_bw()

april_trans_db_plot_striped
```

```{r}
may_trans_db_plot <- ggplot(may_trans_db) + 
  geom_boxplot(aes(x = aspect, y = db_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
may_trans_db_plot <- may_trans_db_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.5082", size = 3, color = "black", fontface = "bold") + 
  theme(legend.position = "none") +
  labs(x = NULL, y = NULL)

may_trans_db_plot
```

```{r}
may_trans_db_plot_striped <- ggplot(may_trans_db) + 
  geom_boxplot_pattern(aes(x = aspect, y = db_temp, fill = aspect),
                       pattern = "stripe",  # Use "stripe" pattern
                       pattern_density = 0.1,  # Adjust density of stripes
                       pattern_fill = "white",  # Fill color for stripes
                       pattern_angle = 45) +  # Angle of the stripes
  facet_wrap(~ zone + burn_status + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  theme_bw()

may_trans_db_plot_striped
```

```{r}
#combining individual month PSZ plots
full_trans_db_plots <- ggarrange(feb_trans_db_plot, march_trans_db_plot, april_trans_db_plot, may_trans_db_plot, 
                                  nrow = 1, ncol = 4)

# Display the plot
print(full_trans_db_plots)
```

```{r}
full_db_plots <- ggarrange(full_pers_db_plots, full_trans_db_plots, nrow = 2, ncol = 1)

#adjusting the labels so they are shared
full_db_plots <- annotate_figure(full_db_plots,
                                  left = textGrob("Temperature (°C)", gp = gpar(fontsize = 10), rot = 90),
                                  bottom = textGrob("Aspect", gp = gpar(fontsize = 10)))


full_db_plots
```

## Live Trees

```{r}
#making a daytime dataframe 
full_15min_ub_dt <- full_15min_gbdbub %>%
  filter(phase == "day") %>%
  select(datetime, day, month, phase, zone, aspect, ub_temp) %>%
  mutate(zone = case_when(
    zone == "persistent" ~ "PSZ", zone == "transitional" ~ "TSZ",
    TRUE ~ zone  # This line ensures other zones are preserved
  )) %>%
  mutate(burn_status = "live")

#parsing into zone dataframes
pers_full_15min_ub_dt <- full_15min_ub_dt %>%
  filter(zone == "PSZ")

#have to filter individually to add p-value to boxes
feb_pers_ub <- pers_full_15min_ub_dt %>%
  filter(month == "2")

march_pers_ub <- pers_full_15min_ub_dt %>%
  filter(month == "3")

april_pers_ub <- pers_full_15min_ub_dt %>%
  filter(month == "4")

may_pers_ub <- pers_full_15min_ub_dt %>%
  filter(month == "5")
  

trans_full_15min_ub_dt <- full_15min_ub_dt %>%
  filter(zone == "TSZ")

#have to filter individually to add p-value to boxes
feb_trans_ub <- trans_full_15min_ub_dt %>%
  filter(month == "2")

march_trans_ub <- trans_full_15min_ub_dt %>%
  filter(month == "3")

april_trans_ub <- trans_full_15min_ub_dt %>%
  filter(month == "4")

may_trans_ub <- trans_full_15min_ub_dt %>%
  filter(month == "5")
```

```{r}
#individual month plots
feb_pers_ub_plot <- ggplot(feb_pers_ub) + 
  geom_boxplot(aes(x = aspect, y = ub_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
feb_pers_ub_plot <- feb_pers_ub_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.000004", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

feb_pers_ub_plot
```

```{r}
march_pers_ub_plot <- ggplot(march_pers_ub) + 
  geom_boxplot(aes(x = aspect, y = ub_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
march_pers_ub_plot <- march_pers_ub_plot + 
  annotate("text", x = 1, y = 35, label = "p =0.0000007", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

march_pers_ub_plot
```

```{r}
april_pers_ub_plot <- ggplot(april_pers_ub) + 
  geom_boxplot(aes(x = aspect, y = ub_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
april_pers_ub_plot <- april_pers_ub_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.000323", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

april_pers_ub_plot
```

```{r}
may_pers_ub_plot <- ggplot(may_pers_ub) + 
  geom_boxplot(aes(x = aspect, y = ub_temp, fill = aspect)) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
may_pers_ub_plot <- may_pers_ub_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.5082", size = 3, color = "black", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

may_pers_ub_plot
```

```{r}
#combining individual month PSZ plots
full_pers_ub_plots <- ggarrange(feb_pers_ub_plot, march_pers_ub_plot, april_pers_ub_plot, may_pers_ub_plot, nrow = 1, ncol = 4)

full_pers_ub_plots
```

Transitional Zone

```{r}
feb_trans_ub_plot <- ggplot(feb_trans_ub) + 
  geom_boxplot(aes(x = aspect, y = ub_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
feb_trans_ub_plot <- feb_trans_ub_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.003518", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

feb_trans_ub_plot
```

```{r}
march_trans_ub_plot <- ggplot(march_trans_ub) + 
  geom_boxplot(aes(x = aspect, y = ub_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
march_trans_ub_plot <- march_trans_ub_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.000256", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

march_trans_ub_plot
```

```{r}
april_trans_ub_plot <- ggplot(april_trans_ub) + 
  geom_boxplot(aes(x = aspect, y = ub_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
april_trans_ub_plot <- april_trans_ub_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.000256", size = 3, color = "red3", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

april_trans_ub_plot
```

```{r}
may_trans_ub_plot <- ggplot(may_trans_ub) + 
  geom_boxplot(aes(x = aspect, y = ub_temp, fill = aspect), alpha = 0.6) + 
  facet_wrap(~ zone + month) + 
  scale_fill_manual(
    values = c("north" = "#2166AC", "south" = "#D95F02"),
    name = "Aspect of Temp Sensor"  # Legend title
  ) + 
  labs(x = "Aspect", y = "Temperature (°C)") +
  ylim(NA, 40) +
  theme_bw()

#adding p-value
may_trans_ub_plot <- may_trans_ub_plot + 
  annotate("text", x = 1, y = 35, label = "p = 0.62080", size = 3, color = "black", fontface = "bold") + 
  theme(legend.position = "none") + 
  labs(x = NULL, y = NULL)

may_trans_ub_plot
```

```{r}
#combining individual month PSZ plots
full_trans_ub_plots <- ggarrange(feb_trans_ub_plot, march_trans_ub_plot, april_trans_ub_plot, may_trans_ub_plot, nrow = 1, ncol = 4)

full_trans_ub_plots
```

```{r}
#combining persistent and transitional zones
full_ub_plots <- ggarrange(full_pers_ub_plots, full_trans_ub_plots, nrow = 2, ncol = 1)

#adjusting the labels so they are shared
full_ub_plots <- annotate_figure(full_ub_plots,
                                  left = textGrob("Temperature (°C)", gp = gpar(fontsize = 10), rot = 90),
                                  bottom = textGrob("Aspect", gp = gpar(fontsize = 10)))

full_ub_plots
```

Full Combo

```{r}
gbdbub_combined_plot <- ggarrange(full_gb_plots, full_db_plots, full_ub_plots,
                            ncol = 1, nrow = 3,  # Stack in a single column
                            labels = c("a)", "b)", "c)"),  # Labeling the plots
                            font.label = list(size = 14, face = "bold"))

gbdbub_combined_plot
```
